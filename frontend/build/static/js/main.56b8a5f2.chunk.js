(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{391:function(e,t,n){e.exports=n(578)},396:function(e,t,n){},403:function(e,t){},405:function(e,t){},416:function(e,t){},418:function(e,t){},445:function(e,t){},447:function(e,t){},448:function(e,t){},454:function(e,t){},456:function(e,t){},474:function(e,t){},476:function(e,t){},488:function(e,t){},491:function(e,t){},578:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(27),c=n.n(o),i=(n(396),n(95),n(377)),l=n(29),u=n(17),s=n(15),m=n(23),p=n(32),d=n(111),b=n(26),g=n(243),f=n.n(g),v=n(82),y=n.n(v);function h(e,t,n){var a={message:e,type:t},r=JSON.stringify(a),o=localStorage.getItem("".concat(n,"-privateKey"));return y.a.AES.encrypt(r,o).toString()}function O(e,t){var n=localStorage.getItem("".concat(t,"-privateKey")),a=y.a.AES.decrypt(e,n);return JSON.parse(a.toString(y.a.enc.Utf8))}function j(e){var t=new f.a;return t.setPrivateKey(localStorage.getItem("user-privateKey")),t.decrypt(e)}function E(){var e=Object(p.a)(["\n    subscription getNewGroups($username: String!){\n        newGroup(username: $username){\n          id\n          users{\n            username\n          }\n          name\n          publicKey\n          privateKey\n        }\n    }\n"]);return E=function(){return e},e}function w(){var e=Object(p.a)(["\n  query getGroupsWithUser($username: String!) {\n    groupsByUser(username: $username){\n      id\n      name\n      users {\n        username\n      }\n      privateKey\n    }\n  }\n"]);return w=function(){return e},e}var S=Object(s.gql)(w()),k=Object(s.gql)(E());var K=function(e){var t=e.selectedGroup,n=e.setSelectedGroup,o=e.setDoneFetching,c=e.client,i=localStorage.getItem("username"),l=Object(s.useQuery)(S,{variables:{username:i}}),u=l.subscribeToMore,m=l.loading,p=l.error,g=l.data,f=l.refetch;if(Object(a.useEffect)((function(){var e=u({document:k,variables:{username:i},updateQuery:function(e,t){var n=t.subscriptionData;if(!n.data)return e;var a=n.data.newGroup;return localStorage.setItem("".concat(a.id,"-privateKey"),j(a.privateKey)),Object.assign({},e,{groupsByUser:[a].concat(Object(d.a)(e.groupsByUser))})}});return function(){e()}}),[u,i]),m)return"Loading...";if(p)return c.resetStore(),f(),"Error! ".concat(p.message);var v=g.groupsByUser.map((function(e){null!=localStorage.getItem("".concat(e.id,"-privateKey"))&&"undefined"!==localStorage.getItem("".concat(e.id,"-privateKey"))||localStorage.setItem("".concat(e.id,"-privateKey"),j(e.privateKey));var a=e.users.map((function(e){return"@".concat(e.username)}));return r.a.createElement("div",{key:e.id,style:e.id===t?{backgroundColor:"#0275d8"}:{},onClick:function(){n(e.id),o(!1)}},r.a.createElement(b.c,{active:e.id===t},r.a.createElement(b.a,{letter:e.name.charAt(0).toUpperCase(),style:{color:"#121212"}}),r.a.createElement(b.d,{fill:"true"},r.a.createElement(b.e,{justify:!0},r.a.createElement(b.h,{ellipsis:!0},e.name)),r.a.createElement(b.e,{justify:!0},r.a.createElement(b.f,{ellipsis:!0},a.join(", "))))))}));return r.a.createElement(b.b,{style:{maxWidth:"100%"}},v)},C=n(132),I=n(170),$=n.n(I),x=n(244);n(216);function M(){var e=Object(p.a)(["\n  display: block;\n  margin: 0 auto;\n  border-color: red;\n"]);return M=function(){return e},e}var T=Object(C.css)(M());var G=function(e){var t=e.entries,n=e.onLoadMore,o=e.doneFetching,c=e.selectedGroup,i=r.a.createRef(),l=r.a.createRef();window.lm=n;var u=[].concat(t.messagesByGroup).reverse(),s=localStorage.getItem("username"),m=u.map((function(e){return null==localStorage.getItem("".concat(c,"-privateKey"))||"undefined"===localStorage.getItem("".concat(c,"-privateKey"))?null:new x.Message({id:e.sender===s?0:e.sender,message:O(e.content,c).message,senderName:"@".concat(e.sender)})})).filter(Boolean);Object(a.useEffect)((function(){i.scrollIntoView({behavior:"smooth"});var e=setInterval((function(){if(!l)return!1;var e=l.getBoundingClientRect().top;e+0>=0&&e-0<=window.innerHeight&&n()}),1e3);return function(){clearInterval(e)}}),[n,l,i]);var p=.86*window.innerHeight;return r.a.createElement("div",{style:{marginLeft:5,marginRight:5,marginBottom:50}},r.a.createElement("div",{style:{height:30},ref:function(e){l=e}},o?r.a.createElement("div",null):r.a.createElement($.a,{css:T,size:30,color:"#123abc",loading:!0})),r.a.createElement("div",{style:{maxHeight:p}},r.a.createElement(x.ChatFeed,{maxHeight:p,messages:m,showSenderName:!0,bubblesCentered:!1,bubbleStyles:{text:{fontSize:14},chatbubble:{borderRadius:30,padding:15,backgroundColor:"#363636"},userBubble:{backgroundColor:"#0084ff"}}})),r.a.createElement("div",{style:{float:"left",clear:"both"},ref:function(e){i=e}}))};function B(){var e=Object(p.a)(["\n  display: block;\n  margin: 0 auto;\n  border-color: red;\n"]);return B=function(){return e},e}function A(){var e=Object(p.a)(["\n    subscription getNewMessages($gid: Int!){\n        newMessage(gid: $gid){\n            id\n            content\n            ts\n            sender\n            group\n            cType\n        }\n    }\n"]);return A=function(){return e},e}function P(){var e=Object(p.a)(["\n    query getMessagesForGroup($gid: Int!, $offset: Int, $limit: Int) {\n        messagesByGroup(gid: $gid, count: $limit, offset: $offset){\n            id\n            content\n            ts\n            sender\n            group\n            cType\n        }\n    }\n"]);return P=function(){return e},e}var q=Object(s.gql)(P()),N=Object(s.gql)(A()),U=Object(C.css)(B());var z=function(e){var t=e.selectedGroup,n=e.doneFetching,o=e.setDoneFetching,c=Object(s.useQuery)(q,{variables:{gid:t,offset:0,limit:50},fetchPolicy:"cache-and-network"}),i=c.subscribeToMore,l=c.loading,u=c.error,m=c.data,p=c.fetchMore;return Object(a.useEffect)((function(){var e=i({document:N,variables:{gid:t},updateQuery:function(e,n){var a=n.subscriptionData;if(!a.data)return e;console.log(a,t);var r=a.data.newMessage;return Object.assign({},e,{messagesByGroup:[r].concat(Object(d.a)(e.messagesByGroup))})}});return function(){e()}}),[i,t]),l?r.a.createElement("div",{style:{marginLeft:"10px",marginRight:"10px",marginBottom:"50px"}},r.a.createElement("div",{style:{height:"30px"}},!n&&r.a.createElement($.a,{css:U,size:30,color:"#123abc",loading:!0}))):u?"Error! ".concat(u.message):r.a.createElement(G,{entries:m,selectedGroup:t,doneFetching:n,onLoadMore:function(){if(!n)return p({variables:{offset:m.messagesByGroup.length},updateQuery:function(e,t){var n=t.fetchMoreResult;return 0===n.messagesByGroup.length&&o(!0),Object.assign({},e,{messagesByGroup:[].concat(Object(d.a)(e.messagesByGroup),Object(d.a)(n.messagesByGroup))})}})}})},L=n(109),F=n(379),R=n(372),D=n.n(R),H=(n(530),n(41)),W=n.n(H),J=n(71),Q=n(162),Y=n.n(Q);function V(e){return String.fromCharCode.apply(null,Array.from(new Uint8Array(e)))}function X(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(J.a)(W.a.mark((function e(t){var n,a,r,o;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.exportKey("spki",t);case 2:return n=e.sent,a=V(n),r=window.btoa(a),o="-----BEGIN PUBLIC KEY-----\n".concat(r,"\n-----END PUBLIC KEY-----"),e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return ee.apply(this,arguments)}function ee(){return(ee=Object(J.a)(W.a.mark((function e(t){var n,a,r,o;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.exportKey("pkcs8",t);case 2:return n=e.sent,a=V(n),r=window.btoa(a),o="-----BEGIN PRIVATE KEY-----\n".concat(r,"\n-----END PRIVATE KEY-----"),e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e,t){return ne.apply(this,arguments)}function ne(){return(ne=Object(J.a)(W.a.mark((function e(t,n){var a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:n,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt","decrypt"]).then(function(){var e=Object(J.a)(W.a.mark((function e(n){var a,r;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X(n.publicKey);case 2:return a=e.sent,e.next=5,_(n.privateKey);case 5:return r=e.sent,e.abrupt("return",{privateKey:r,username:t,publicKey:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e){return Y.a.pbkdf2Sync(e,"salt",1,32,"sha512").toString("hex")}function re(){var e=JSON.stringify(localStorage),t=localStorage.getItem("password")||"";return y.a.AES.encrypt(e,t).toString()}function oe(e,t){var n=y.a.AES.decrypt(e,t);try{for(var a=JSON.parse(n.toString(y.a.enc.Utf8)),r=0,o=Object.entries(a);r<o.length;r++){var c=Object(m.a)(o[r],2),i=c[0],l=c[1];localStorage.setItem(i,l)}}catch(u){return console.error(u),!1}return!0}var ce=n(112),ie=n(83);function le(){var e=Object(p.a)(["\n    mutation updateKeys($username: String!, $keys: String!){\n        updateKeys(username:$username, keys:$keys){\n            success\n        }\n    }\n"]);return le=function(){return e},e}function ue(){var e=Object(p.a)(["\n    mutation createPrivateKey($username: String!, $privateKey: String!, $gid: Int!){\n        createPrivateKey(username:$username, gid:$gid, privateKey:$privateKey){\n            id\n            privateKey\n        }\n    }\n"]);return ue=function(){return e},e}function se(){var e=Object(p.a)(["\nmutation createGroup($name: String!, $publicKey: String!, $users: [String!]){\n    createGroup(name:$name, publicKey:$publicKey, users:$users){\n      id\n      name\n      publicKey\n      users{\n          username\n          publicKey\n      }\n    }\n  }\n"]);return se=function(){return e},e}var me=Object(s.gql)(se()),pe=Object(s.gql)(ue()),de=Object(s.gql)(le());var be=function(e){var t=e.show,n=e.setShow,o=Object(a.useState)([]),c=Object(m.a)(o,2),i=c[0],l=c[1],u=function(){return n(!1)},p=Object(a.useState)(""),d=Object(m.a)(p,2),b=d[0],g=d[1],v=Object(s.useMutation)(de),y=Object(m.a)(v,1)[0],h=Object(s.useMutation)(pe),O=Object(m.a)(h,1)[0],j=Object(s.useMutation)(me,{onCompleted:function(e){var t=e.createGroup,n=localStorage.getItem("username"),a=localStorage.getItem("temp-group-privatekey");localStorage.setItem("".concat(t.id,"-privateKey"),a),localStorage.removeItem("temp-group-privatekey"),t.users.map((function(e){var n=function(e,t){var n=new f.a;return n.setPublicKey(t.publicKey),n.encrypt(e)}(a,e);return O({variables:{username:e.username,gid:t.id,privateKey:n}}),!0})),y({variables:{username:n,keys:re()}}),u()}}),E=Object(m.a)(j,1)[0];return r.a.createElement("div",{style:{backgroundColor:"#2e2e2e"}},r.a.createElement(ce.a,{show:t,transparent:"true",onHide:u},r.a.createElement(ce.a.Header,{closeButton:!0,style:{backgroundColor:"#2e2e2e",borderColor:"#2e2e2e"}},r.a.createElement(ce.a.Title,null,"Input the individuals to add to your new Group Chat!")),r.a.createElement(ce.a.Body,{style:{backgroundColor:"#2e2e2e",borderColor:"#2e2e2e"}},r.a.createElement(D.a,{style:{color:"white"},value:i,onChange:function(e){return l(e)},inputProps:{className:"react-tagsinput-input",placeholder:"Add people!"},onlyUnique:!0}),r.a.createElement(ie.a,{style:{marginTop:"20px"}},r.a.createElement(ie.a.Group,null,r.a.createElement(ie.a.Control,{testid:"createGroupInputField",style:{color:"black"},type:"text",placeholder:"Group Name",value:b,onChange:function(e){return g(e.target.value)}})))),r.a.createElement(ce.a.Footer,{style:{backgroundColor:"#2e2e2e",borderColor:"#2e2e2e"}},r.a.createElement(L.a,{variant:"secondary",onClick:u},"Close"),r.a.createElement(L.a,{variant:"primary",onClick:function(){return function(e,t){e.push(localStorage.getItem("username"));var n=e.filter((function(e,t,n){return n.indexOf(e)===t}));n&&n.length>0?Promise.resolve(te(t,256)).then((function(e){var a=e.publicKey,r=e.privateKey;localStorage.setItem("temp-group-privatekey",r),E({variables:{users:n,publicKey:a,name:t}})})):console.log("Error, you have no individuals to add to the group")}(i,b)}},"Create Group!"))))};function ge(){var e=Object(p.a)(["\n    mutation SendMessage($username: String!, $content: String!, $gid: Int!, $cType: String!){\n        createMessage(sender:$username, group:$gid, content:$content, cType:$cType){\n            id\n            content\n            ts\n        }\n    }\n"]);return ge=function(){return e},e}var fe=Object(s.gql)(ge()),ve={defaultTheme:{FixedWrapperMaximized:{css:{boxShadow:"0 0 1em rgba(0, 0, 0, 0.1)"}},OwnMessage:Object(u.a)(Object(u.a)({},b.j.OwnMessage),{},{backgroundColor:"#456456",secondaryTextColor:"#456456"})},purpleTheme:Object(u.a)(Object(u.a)({},b.l),{},{TextComposer:Object(u.a)(Object(u.a)({},b.l.TextComposer),{},{css:Object(u.a)(Object(u.a)({},b.l.TextComposer.css),{},{marginTop:"1em"})}),OwnMessage:Object(u.a)(Object(u.a)({},b.l.OwnMessage),{},{secondaryTextColor:"#fff"})}),elegantTheme:Object(u.a)(Object(u.a)({},b.k),{},{Message:Object(u.a)(Object(u.a)({},b.i.Message),{},{secondaryTextColor:"#fff"}),OwnMessage:Object(u.a)(Object(u.a)({},b.i.OwnMessage),{},{secondaryTextColor:"#fff"})}),darkTheme:Object(u.a)(Object(u.a)({},b.i),{},{vars:Object(u.a)(Object(u.a)({},b.i.vars),{},{"tertiary-color":"rgba(40, 40, 40, 0.8)"}),Message:Object(u.a)(Object(u.a)({},b.i.Message),{},{css:Object(u.a)(Object(u.a)({},b.i.Message.css),{},{color:"#fff"})}),OwnMessage:Object(u.a)(Object(u.a)({},b.i.OwnMessage),{},{secondaryTextColor:"#fff"}),TitleBar:Object(u.a)(Object(u.a)({},b.i.TitleBar),{},{css:Object(u.a)(Object(u.a)({},b.i.TitleBar.css),{},{padding:"1em"})})})};var ye=function(e){var t=e.client;console.log(ve.darkTheme);var n=localStorage.getItem("username"),o=Object(a.useState)(""),c=Object(m.a)(o,2),i=c[0],l=c[1],u=Object(s.useMutation)(fe),p=Object(m.a)(u,1)[0],d=Object(a.useState)(null),g=Object(m.a)(d,2),f=g[0],v=g[1],y=Object(a.useState)(!1),O=Object(m.a)(y,2),j=O[0],E=O[1],w=Object(a.useState)(!1),S=Object(m.a)(w,2),k=S[0],C=S[1];return r.a.createElement("div",{className:"main"},r.a.createElement(be,{show:k,setShow:C}),r.a.createElement(b.g,{theme:ve.darkTheme},r.a.createElement("div",{style:{height:"100%",width:"30%",position:"fixed",zIndex:1,top:0,overflowX:"hidden",paddingTop:"20px",left:0}},r.a.createElement("div",{style:{verticalAlign:"middle",fontSize:24}},r.a.createElement(F.a,{name:n,size:50,round:!0,style:{marginBottom:20,marginLeft:25},title:"@".concat(n)})," ","@".concat(n)),r.a.createElement("div",{className:"App",style:{marginBottom:10}},r.a.createElement(L.a,{variant:"primary",style:{marginRight:"10px"},onClick:function(){return C(!k)}},"Create Group Chat"),r.a.createElement(L.a,{variant:"secondary",onClick:function(){localStorage.clear();var e=window.location.href.split("/");e.pop();var t=e.join("/");window.location.href=t}},"Logout")),r.a.createElement(K,{client:t,selectedGroup:f,setSelectedGroup:v,setDoneFetching:E})),r.a.createElement("div",{style:{height:"100%",width:"70%",position:"fixed",zIndex:1,top:0,overflowX:"hidden",right:0,border:"1px solid rgba(108, 117, 125, 0.1)"}},f&&r.a.createElement(r.a.Fragment,null,r.a.createElement(z,{selectedGroup:f,doneFetching:j,setDoneFetching:E}),r.a.createElement(ie.a,{style:{width:"68%",bottom:"20px",position:"fixed",marginLeft:"0",marginRight:"0",display:"block",left:"31%"}},r.a.createElement(ie.a.Group,null,r.a.createElement(ie.a.Control,{type:"text",placeholder:"Enter message",value:i,style:{backgroundColor:"#363636",color:"white",borderColor:"#363636"},onChange:function(e){return l(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&""!==e.target.value&&(e.preventDefault(),p({variables:{username:n,gid:f,content:h(i,"text",f),cType:"text"}}),l(""))}})))))))},he=n(173),Oe=n(4),je=n(174);var Ee=function(){var e=window.location.href.includes("https://rithik.me/"),t=e?"https://e2-chat.herokuapp.com":"http://localhost:4000",n=e?"wss://e2-chat.herokuapp.com":"ws://localhost:4000",a=localStorage.getItem("token"),o=Object(s.createHttpLink)({uri:"".concat(t,"/graphql")}),c=Object(he.a)((function(e,t){var n=t.headers;return{headers:Object(u.a)(Object(u.a)({},n),{},{authorization:a?"".concat(a):""})}})),i=new je.a({uri:"".concat(n,"/graphql"),options:{reconnect:!0,connectionParams:{Authorization:a}}}),l=Object(s.split)((function(e){var t=e.query,n=Object(Oe.p)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),i,c.concat(o)),m=new s.ApolloClient({link:l,cache:new s.InMemoryCache});return r.a.createElement(s.ApolloProvider,{client:m},r.a.createElement("div",null,r.a.createElement(ye,{client:m})))},we=n(612),Se=n(616),ke=n(617),Ke=n(615),Ce=n(614),Ie=n(247),$e=n.n(Ie),xe=n(380),Me=n(246),Te=n(613),Ge=n(378),Be=n(608);function Ae(){var e=Object(p.a)(["\n    mutation updateKeys($username: String!, $keys: String!){\n        updateKeys(username:$username, keys:$keys){\n            success\n        }\n    }\n"]);return Ae=function(){return e},e}function Pe(){var e=Object(p.a)(["\n\tquery User($username: String!){\n\t\tuser(username:$username){\n\t\t\tusername\n\t\t\tid\n\t\t\tkeys\n\t\t}\n\t}\n"]);return Pe=function(){return e},e}function qe(){var e=Object(p.a)(["\n\tmutation CreateToken($username: String!, $publicKey: String!){\n\t\t  createToken(username:$username, publicKey:$publicKey){\n\t\t    token\n\t\t    username\n\t\t}\n\t}\n"]);return qe=function(){return e},e}function Ne(){var e=Object(p.a)(["\n\tmutation CreateUser($username: String!, $publicKey: String!){\n\t  createUser(username:$username, publicKey:$publicKey){\n\t    id\n\t    username\n\t    publicKey\n\t  }\n\t}\n"]);return Ne=function(){return e},e}var Ue=Object(Ge.a)({overrides:{MuiFormLabel:{root:{color:"white",borderColor:"white"}},MuiOutlinedInput:{root:{"& $notchedOutline":{borderColor:"rgba(255, 255, 255, 0.23)"},"&:hover:not($disabled):not($focused):not($error) $notchedOutline":{borderColor:"#4A90E2","@media (hover: none)":{borderColor:"rgba(255, 255, 255, 0.23)"}},"&$focused $notchedOutline":{borderColor:"#4A90E2",borderWidth:1}}},MuiInput:{input:{"&::placeholder":{color:"gray"},color:"white"}}}}),ze=Object(s.gql)(Ne()),Le=Object(s.gql)(qe()),Fe=Object(s.gql)(Pe()),Re=Object(s.gql)(Ae());var De=function(){var e=Object(s.useMutation)(Re),t=Object(m.a)(e,1)[0],n=Object(s.useMutation)(ze,{onCompleted:function(e){var t=e.createUser,n=t.username,a=t.publicKey;i({variables:{username:n,publicKey:a}})}}),o=Object(m.a)(n,1)[0],c=Object(s.useMutation)(Le,{onCompleted:function(e){var n=e.createToken,a="login"===F?K:y;localStorage.setItem("token",n.token),localStorage.setItem("username",n.username),localStorage.setItem("password",ae(a)),t({variables:{username:n.username,keys:re()}}),window.location.href=window.location.href+"main"}}),i=Object(m.a)(c,1)[0],l=Object(s.useMutation)(Le,{onCompleted:function(e){var t=e.createToken;localStorage.setItem("token",t.token),window.location.href=window.location.href+"main"}}),u=Object(m.a)(l,1)[0],p=Object(a.useState)(""),d=Object(m.a)(p,2),b=d[0],g=d[1],f=Object(a.useState)(""),v=Object(m.a)(f,2),y=v[0],h=v[1],O=Object(a.useState)(""),j=Object(m.a)(O,2),E=j[0],w=j[1],S=Object(a.useState)(""),k=Object(m.a)(S,2),K=k[0],C=k[1],I=Object(a.useState)(!1),$=Object(m.a)(I,2),x=$[0],M=$[1],T=Object(a.useState)(!1),G=Object(m.a)(T,2),B=G[0],A=G[1],P=Object(a.useState)(!1),q=Object(m.a)(P,2),N=q[0],U=q[1],z=Object(a.useState)("login"),L=Object(m.a)(z,2),F=L[0],R=L[1],D=Object(s.useQuery)(Fe,{variables:{username:"login"===F?E:b}}),H=D.error,Q=D.refetch,Y=function(){var e=Object(J.a)(W.a.mark((function e(t){var n;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="login"===F?E:b,Promise.resolve(te(t,4096)).then((function(e){var t=e.publicKey,a=e.privateKey;o({variables:{username:n,publicKey:t}}),localStorage.setItem("user-publicKey",t),localStorage.setItem("user-privateKey",a),localStorage.setItem("username",n)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(J.a)(W.a.mark((function e(){var t,n;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q({username:b});case 2:t=e.sent,n=t.data,H?Y(b):null==n.user?(M(!1),Y(b)):(M(!0),U(!1));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(J.a)(W.a.mark((function e(){var t,n,a,r,o;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q({username:E});case 2:t=e.sent,n=t.data,console.log(n),H?(console.error(H),A(!0),U(!1)):null===n.user?(A(!0),U(!1)):(a=ae(K),oe(n.user.keys,a)?(r=localStorage.getItem("username"),o=localStorage.getItem("user-publicKey"),u({variables:{username:r,publicKey:o}})):(A(!0),U(!1)));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Be.a,{theme:Ue},r.a.createElement(xe.a,{fill:!0,id:"controlled-tab-example",className:"tabHeadings",activeKey:F,onSelect:function(e){return R(e)}},r.a.createElement(Me.a,{eventKey:"login",title:"Login"},r.a.createElement("div",{className:"register"},r.a.createElement(Se.a,{InputProps:{style:{color:"white"}},id:"outlined-basic",label:"Username",variant:"outlined",value:E,color:"secondary",fullWidth:!0,onChange:function(e){return w(e.target.value)}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Se.a,{InputProps:{style:{color:"white"}},id:"outlined-basic",label:"Password",variant:"outlined",value:K,type:"password",color:"secondary",fullWidth:!0,onChange:function(e){return C(e.target.value)}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(we.a,{disabled:N,onClick:function(e){e.preventDefault(),U(!0),X()},variant:"contained",color:"secondary"},N&&r.a.createElement(Te.a,{size:20,style:{color:"white",marginRight:"10px"}})," Login"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Ce.a,{in:B},r.a.createElement(ke.a,{action:r.a.createElement(Ke.a,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){A(!1)}},r.a.createElement($e.a,{fontSize:"inherit"})),variant:"filled",severity:"error"},"Invalid Login")))),r.a.createElement(Me.a,{eventKey:"register",title:"Register"},r.a.createElement("div",{className:"register"},r.a.createElement(Se.a,{InputProps:{style:{color:"white"}},id:"outlined-basic",label:"Username",variant:"outlined",value:b,color:"secondary",fullWidth:!0,onChange:function(e){return g(e.target.value)}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Se.a,{InputProps:{style:{color:"white"}},id:"outlined-basic",label:"Password",variant:"outlined",value:y,type:"password",color:"secondary",fullWidth:!0,onChange:function(e){return h(e.target.value)}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(we.a,{disabled:N,onClick:function(e){e.preventDefault(),U(!0),V()},variant:"contained",color:"secondary"},N&&r.a.createElement(Te.a,{size:20,style:{color:"white",marginRight:"10px"}})," Register"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Ce.a,{in:x},r.a.createElement(ke.a,{action:r.a.createElement(Ke.a,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){M(!1)}},r.a.createElement($e.a,{fontSize:"inherit"})),variant:"filled",severity:"error"},"Invalid username - choose a unique username"))))))};var He=function(){var e=window.location.href.includes("https://rithik.me/"),t=e?"https://e2-chat.herokuapp.com":"http://localhost:4000",n=e?"wss://e2-chat.herokuapp.com":"ws://localhost:4000",a=localStorage.getItem("token"),o=Object(s.createHttpLink)({uri:"".concat(t,"/graphql")}),c=Object(he.a)((function(e,t){var n=t.headers;return{headers:Object(u.a)(Object(u.a)({},n),{},{authorization:a?"".concat(a):""})}})),i=new je.a({uri:"".concat(n,"/graphql"),options:{reconnect:!0,connectionParams:{Authorization:a}}}),l=Object(s.split)((function(e){var t=e.query,n=Object(Oe.p)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),i,c.concat(o)),m=new s.ApolloClient({link:l,cache:new s.InMemoryCache});return r.a.createElement(s.ApolloProvider,{client:m},r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(De,null))))};var We=function(){return r.a.createElement(i.a,{basename:"/"},r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"/main"},r.a.createElement(Ee,null)),r.a.createElement(l.a,{path:"/"},r.a.createElement(He,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(We,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},95:function(e,t,n){}},[[391,1,2]]]);
//# sourceMappingURL=main.56b8a5f2.chunk.js.map