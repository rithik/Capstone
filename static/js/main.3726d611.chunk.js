(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{419:function(e,t,n){e.exports=n(698)},424:function(e,t,n){},523:function(e,t){},525:function(e,t){},536:function(e,t){},538:function(e,t){},565:function(e,t){},567:function(e,t){},568:function(e,t){},574:function(e,t){},576:function(e,t){},594:function(e,t){},596:function(e,t){},608:function(e,t){},611:function(e,t){},698:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(25),c=n.n(o),i=(n(424),n(86),n(405)),s=n(28),u=n(17),l=n(15),m=n(23),p=n(32),d=n(76),g=n(35),b=n(94),f=(n(101),n(259)),v=n.n(f),y=n(85),h=n.n(y);function O(e,t,n){var a={message:e,type:t},r=JSON.stringify(a),o=localStorage.getItem("".concat(n,"-privateKey"));return h.a.AES.encrypt(r,o).toString()}function j(e,t){var n=localStorage.getItem("".concat(t,"-privateKey")),a=h.a.AES.decrypt(e,n);return JSON.parse(a.toString(h.a.enc.Utf8))}function E(e){var t=new v.a;return t.setPrivateKey(localStorage.getItem("user-privateKey")),t.decrypt(e)}function w(){var e=Object(p.a)(["\n    subscription getNewGroups($username: String!){\n        newGroup(username: $username){\n          id\n          users{\n            username\n          }\n          name\n          publicKey\n          privateKey\n        }\n    }\n"]);return w=function(){return e},e}function S(){var e=Object(p.a)(["\n  query getGroupsWithUser($username: String!) {\n    groupsByUser(username: $username){\n      id\n      name\n      users {\n        username\n      }\n      privateKey\n    }\n  }\n"]);return S=function(){return e},e}var k=Object(l.gql)(S()),K=Object(l.gql)(w());var I=function(e){var t=e.selectedGroup,n=e.setSelectedGroup,o=e.setDoneFetching,c=e.client,i=localStorage.getItem("username"),s=Object(l.useQuery)(k,{variables:{username:i}}),u=s.subscribeToMore,m=s.loading,p=s.error,g=s.data,f=s.refetch;if(Object(a.useEffect)((function(){var e=u({document:K,variables:{username:i},updateQuery:function(e,t){var n=t.subscriptionData;if(!n.data)return e;var a=n.data.newGroup;return localStorage.setItem("".concat(a.id,"-privateKey"),E(a.privateKey)),Object.assign({},e,{groupsByUser:[a].concat(Object(d.a)(e.groupsByUser))})}});return function(){e()}}),[u,i]),m)return"Loading...";if(p)return c.resetStore(),f(),"Error! ".concat(p.message);var v=function(e){for(var t=0,n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);var a="#";for(n=0;n<3;n++){a+=("00"+(t>>8*n&255).toString(16)).substr(-2)}return a},y=g.groupsByUser.map((function(e){null!=localStorage.getItem("".concat(e.id,"-privateKey"))&&"undefined"!==localStorage.getItem("".concat(e.id,"-privateKey"))||localStorage.setItem("".concat(e.id,"-privateKey"),E(e.privateKey));var n=e.users.map((function(e){return"@".concat(e.username)}));return{letterItem:{letter:e.name.charAt(0).toUpperCase(),id:v(e.name)},alt:e.name,title:e.name,subtitle:n.join(", "),date:new Date,unread:0,id:e.id,className:t===e.id?"activeChatLeft":"notActiveChatLeft"}}));return console.log(y),r.a.createElement(b.ChatList,{onClick:function(e){console.log(e),n(e.id),o(!1)},style:{backgroundColor:"#121212"},dataSource:y})},C=n(138),$=n(183),x=n.n($);n(343),n(232);function T(){var e=Object(p.a)(["\n  display: block;\n  margin: 0 auto;\n  border-color: red;\n"]);return T=function(){return e},e}var M=Object(C.css)(T());var B=function(e){var t=e.messages,n=e.onLoadMore,o=e.doneFetching,c=(e.selectedGroup,r.a.createRef()),i=r.a.createRef();window.lm=n,Object(a.useEffect)((function(){c.scrollIntoView({behavior:"smooth"});var e=setInterval((function(){if(!i)return!1;var e=i.getBoundingClientRect().top;e+0>=0&&window.innerHeight}),1e3);return function(){clearInterval(e)}}),[n,i,c]);var s=.86*window.innerHeight,u=localStorage.getItem("username"),l=t.map((function(e){return"text"===e.cType?{position:e.sender===u?"right":"left",type:"text",text:e.message,title:e.senderName,date:new Date(parseInt(e.ts))}:null})).filter(Boolean);return r.a.createElement("div",{style:{marginLeft:5,marginRight:5,marginBottom:50}},r.a.createElement("div",{style:{height:30},ref:function(e){i=e}},o?r.a.createElement("div",null):r.a.createElement(x.a,{css:M,size:30,color:"#123abc",loading:!0})),r.a.createElement("div",{style:{maxHeight:s}},r.a.createElement(b.MessageList,{className:"message-list",lockable:!0,toBottomHeight:"86%",dataSource:l})),r.a.createElement("div",{style:{float:"left",clear:"both"},ref:function(e){c=e}}))};function G(){var e=Object(p.a)(["\n  display: block;\n  margin: 0 auto;\n  border-color: red;\n"]);return G=function(){return e},e}function A(){var e=Object(p.a)(["\n    subscription getNewMessages($gid: Int!){\n        newMessage(gid: $gid){\n            id\n            content\n            ts\n            sender\n            group\n            cType\n        }\n    }\n"]);return A=function(){return e},e}function N(){var e=Object(p.a)(["\n    query getMessagesForGroup($gid: Int!, $offset: Int, $limit: Int) {\n        messagesByGroup(gid: $gid, count: $limit, offset: $offset){\n            id\n            content\n            ts\n            sender\n            group\n            cType\n        }\n    }\n"]);return N=function(){return e},e}var P=Object(l.gql)(N()),q=Object(l.gql)(A()),L=Object(C.css)(G());var U=function(e){var t=e.selectedGroup,n=e.doneFetching,o=e.setDoneFetching,c=Object(a.useState)([]),i=Object(m.a)(c,2),s=i[0],u=i[1];console.log(t);var p=Object(l.useQuery)(P,{variables:{gid:t,offset:0,limit:50},fetchPolicy:"network"}),g=p.subscribeToMore,b=p.loading,f=p.error,v=p.data,y=p.fetchMore;return Object(a.useEffect)((function(){localStorage.getItem("username");if(console.log(t),v){var e=[].concat(v.messagesByGroup).reverse().map((function(e){return null==localStorage.getItem("".concat(t,"-privateKey"))||"undefined"===localStorage.getItem("".concat(t,"-privateKey"))?null:{sender:e.sender,message:j(e.content,t).message,senderName:"@".concat(e.sender),cType:e.cType,ts:e.ts}})).filter(Boolean);u(e)}var n=g({document:q,variables:{gid:t},updateQuery:function(e,n){var a=n.subscriptionData;if(!a.data)return o(!0),e;var r=a.data.newMessage,c={sender:r.sender,message:j(r.content,t).message,senderName:"@".concat(r.sender),cType:r.cType,ts:r.ts};return u((function(e){return[].concat(Object(d.a)(e),[c])})),Object.assign({},e,{messagesByGroup:[r].concat(Object(d.a)(e.messagesByGroup))})}});return function(){n()}}),[g,t,v]),b?r.a.createElement("div",{style:{marginLeft:"10px",marginRight:"10px",marginBottom:"50px"}},r.a.createElement("div",{style:{height:"30px"}},!n&&r.a.createElement(x.a,{css:L,size:30,color:"#123abc",loading:!0}))):f?"Error! ".concat(f.message):r.a.createElement(B,{messages:s,selectedGroup:t,doneFetching:n,onLoadMore:function(){if(!n)return y({variables:{offset:v.messagesByGroup.length},updateQuery:function(e,n){var a=n.fetchMoreResult;0===a.messagesByGroup.length&&o(!0);var r=a.messagesByGroup,c=(localStorage.getItem("username"),r.map((function(e){return null==localStorage.getItem("".concat(t,"-privateKey"))||"undefined"===localStorage.getItem("".concat(t,"-privateKey"))?null:{sender:e.sender,message:j(e.content,t).message,senderName:"@".concat(e.sender),cType:e.cType,ts:e.ts}})).filter(Boolean));return u((function(e){return[].concat(Object(d.a)(e),Object(d.a)(c))})),Object.assign({},e,{messagesByGroup:[].concat(Object(d.a)(e.messagesByGroup),Object(d.a)(a.messagesByGroup))})}})}})},z=n(115),D=n(407),F=n(400),R=n.n(F),H=(n(650),n(42)),W=n.n(H),J=n(74),Q=n(175),V=n.n(Q);function Y(e){return String.fromCharCode.apply(null,Array.from(new Uint8Array(e)))}function X(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(J.a)(W.a.mark((function e(t){var n,a,r,o;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.exportKey("spki",t);case 2:return n=e.sent,a=Y(n),r=window.btoa(a),o="-----BEGIN PUBLIC KEY-----\n".concat(r,"\n-----END PUBLIC KEY-----"),e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return ee.apply(this,arguments)}function ee(){return(ee=Object(J.a)(W.a.mark((function e(t){var n,a,r,o;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.exportKey("pkcs8",t);case 2:return n=e.sent,a=Y(n),r=window.btoa(a),o="-----BEGIN PRIVATE KEY-----\n".concat(r,"\n-----END PRIVATE KEY-----"),e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e,t){return ne.apply(this,arguments)}function ne(){return(ne=Object(J.a)(W.a.mark((function e(t,n){var a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:n,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},!0,["encrypt","decrypt"]).then(function(){var e=Object(J.a)(W.a.mark((function e(n){var a,r;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X(n.publicKey);case 2:return a=e.sent,e.next=5,_(n.privateKey);case 5:return r=e.sent,e.abrupt("return",{privateKey:r,username:t,publicKey:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e){return V.a.pbkdf2Sync(e,"salt",1,32,"sha512").toString("hex")}function re(){var e=JSON.stringify(localStorage),t=localStorage.getItem("password")||"";return h.a.AES.encrypt(e,t).toString()}function oe(e,t){var n=h.a.AES.decrypt(e,t);try{for(var a=JSON.parse(n.toString(h.a.enc.Utf8)),r=0,o=Object.entries(a);r<o.length;r++){var c=Object(m.a)(o[r],2),i=c[0],s=c[1];localStorage.setItem(i,s)}}catch(u){return console.error(u),!1}return!0}var ce=n(117),ie=n(144);function se(){var e=Object(p.a)(["\n    mutation updateKeys($username: String!, $keys: String!){\n        updateKeys(username:$username, keys:$keys){\n            success\n        }\n    }\n"]);return se=function(){return e},e}function ue(){var e=Object(p.a)(["\n    mutation createPrivateKey($username: String!, $privateKey: String!, $gid: Int!){\n        createPrivateKey(username:$username, gid:$gid, privateKey:$privateKey){\n            id\n            privateKey\n        }\n    }\n"]);return ue=function(){return e},e}function le(){var e=Object(p.a)(["\nmutation createGroup($name: String!, $publicKey: String!, $users: [String!]){\n    createGroup(name:$name, publicKey:$publicKey, users:$users){\n      id\n      name\n      publicKey\n      users{\n          username\n          publicKey\n      }\n    }\n  }\n"]);return le=function(){return e},e}var me=Object(l.gql)(le()),pe=Object(l.gql)(ue()),de=Object(l.gql)(se());var ge=function(e){var t=e.show,n=e.setShow,o=Object(a.useState)([]),c=Object(m.a)(o,2),i=c[0],s=c[1],u=function(){return n(!1)},p=Object(a.useState)(""),d=Object(m.a)(p,2),g=d[0],b=d[1],f=Object(l.useMutation)(de),y=Object(m.a)(f,1)[0],h=Object(l.useMutation)(pe),O=Object(m.a)(h,1)[0],j=Object(l.useMutation)(me,{onCompleted:function(e){var t=e.createGroup,n=localStorage.getItem("username"),a=localStorage.getItem("temp-group-privatekey");localStorage.setItem("".concat(t.id,"-privateKey"),a),localStorage.removeItem("temp-group-privatekey"),t.users.map((function(e){var n=function(e,t){var n=new v.a;return n.setPublicKey(t.publicKey),n.encrypt(e)}(a,e);return O({variables:{username:e.username,gid:t.id,privateKey:n}}),!0})),y({variables:{username:n,keys:re()}}),u()}}),E=Object(m.a)(j,1)[0];return r.a.createElement("div",{style:{backgroundColor:"#2e2e2e"}},r.a.createElement(ce.a,{show:t,transparent:"true",onHide:u},r.a.createElement(ce.a.Header,{closeButton:!0,style:{backgroundColor:"#2e2e2e",borderColor:"#2e2e2e"}},r.a.createElement(ce.a.Title,null,"Input the individuals to add to your new Group Chat!")),r.a.createElement(ce.a.Body,{style:{backgroundColor:"#2e2e2e",borderColor:"#2e2e2e"}},r.a.createElement(R.a,{style:{color:"white"},value:i,onChange:function(e){return s(e)},inputProps:{className:"react-tagsinput-input",placeholder:"Add people!"},onlyUnique:!0}),r.a.createElement(ie.a,{style:{marginTop:"20px"}},r.a.createElement(ie.a.Group,null,r.a.createElement(ie.a.Control,{testid:"createGroupInputField",style:{color:"black"},type:"text",placeholder:"Group Name",value:g,onChange:function(e){return b(e.target.value)}})))),r.a.createElement(ce.a.Footer,{style:{backgroundColor:"#2e2e2e",borderColor:"#2e2e2e"}},r.a.createElement(z.a,{variant:"secondary",onClick:u},"Close"),r.a.createElement(z.a,{variant:"primary",onClick:function(){return function(e,t){e.push(localStorage.getItem("username"));var n=e.filter((function(e,t,n){return n.indexOf(e)===t}));n&&n.length>0?Promise.resolve(te(t,256)).then((function(e){var a=e.publicKey,r=e.privateKey;localStorage.setItem("temp-group-privatekey",r),E({variables:{users:n,publicKey:a,name:t}})})):console.log("Error, you have no individuals to add to the group")}(i,g)}},"Create Group!"))))};function be(){var e=Object(p.a)(["\n    mutation SendMessage($username: String!, $content: String!, $gid: Int!, $cType: String!){\n        createMessage(sender:$username, group:$gid, content:$content, cType:$cType){\n            id\n            content\n            ts\n        }\n    }\n"]);return be=function(){return e},e}var fe=Object(l.gql)(be()),ve={defaultTheme:{FixedWrapperMaximized:{css:{boxShadow:"0 0 1em rgba(0, 0, 0, 0.1)"}},OwnMessage:Object(u.a)(Object(u.a)({},g.c.OwnMessage),{},{backgroundColor:"#456456",secondaryTextColor:"#456456"})},purpleTheme:Object(u.a)(Object(u.a)({},g.e),{},{TextComposer:Object(u.a)(Object(u.a)({},g.e.TextComposer),{},{css:Object(u.a)(Object(u.a)({},g.e.TextComposer.css),{},{marginTop:"1em"})}),OwnMessage:Object(u.a)(Object(u.a)({},g.e.OwnMessage),{},{secondaryTextColor:"#fff"})}),elegantTheme:Object(u.a)(Object(u.a)({},g.d),{},{Message:Object(u.a)(Object(u.a)({},g.b.Message),{},{secondaryTextColor:"#fff"}),OwnMessage:Object(u.a)(Object(u.a)({},g.b.OwnMessage),{},{secondaryTextColor:"#fff"})}),darkTheme:Object(u.a)(Object(u.a)({},g.b),{},{vars:Object(u.a)(Object(u.a)({},g.b.vars),{},{"tertiary-color":"rgba(40, 40, 40, 0.8)"}),Message:Object(u.a)(Object(u.a)({},g.b.Message),{},{css:Object(u.a)(Object(u.a)({},g.b.Message.css),{},{color:"#fff"})}),OwnMessage:Object(u.a)(Object(u.a)({},g.b.OwnMessage),{},{secondaryTextColor:"#fff"}),TitleBar:Object(u.a)(Object(u.a)({},g.b.TitleBar),{},{css:Object(u.a)(Object(u.a)({},g.b.TitleBar.css),{},{padding:"1em"})})})};var ye=function(e){var t=e.client,n=Object(a.useRef)(null),o=localStorage.getItem("username"),c=Object(a.useState)(""),i=Object(m.a)(c,2),s=(i[0],i[1],Object(l.useMutation)(fe)),u=Object(m.a)(s,1)[0],p=Object(a.useState)(null),d=Object(m.a)(p,2),f=d[0],v=d[1],y=Object(a.useState)(!1),h=Object(m.a)(y,2),j=h[0],E=h[1],w=Object(a.useState)(!1),S=Object(m.a)(w,2),k=S[0],K=S[1];return r.a.createElement("div",{className:"main"},r.a.createElement(ge,{show:k,setShow:K}),r.a.createElement(g.a,{theme:ve.darkTheme},r.a.createElement("div",{style:{height:"100%",width:"30%",position:"fixed",zIndex:1,top:0,overflowX:"hidden",paddingTop:"20px",left:0}},r.a.createElement("div",{style:{verticalAlign:"middle",fontSize:24}},r.a.createElement(D.a,{name:o,size:50,round:!0,style:{marginBottom:20,marginLeft:25},title:"@".concat(o)})," ","@".concat(o)),r.a.createElement("div",{className:"App",style:{marginBottom:10}},r.a.createElement(z.a,{variant:"primary",style:{marginRight:"10px"},onClick:function(){return K(!k)}},"Create Group Chat"),r.a.createElement(z.a,{variant:"secondary",onClick:function(){localStorage.clear();var e=window.location.href.split("/");e.pop();var t=e.join("/");window.location.href=t}},"Logout")),r.a.createElement(I,{client:t,selectedGroup:f,setSelectedGroup:v,setDoneFetching:E})),r.a.createElement("div",{style:{height:"100%",width:"70%",position:"fixed",zIndex:1,top:0,overflowX:"hidden",right:0,border:"1px solid rgba(108, 117, 125, 0.1)"}},f&&r.a.createElement(r.a.Fragment,null,r.a.createElement(U,{selectedGroup:f,doneFetching:j,setDoneFetching:E}),r.a.createElement(b.Input,{placeholder:"Enter message",defaultValue:"",ref:n,multiline:!0,onKeyPress:function(e){return!(!e.shiftKey||13!==e.charCode)||(13===e.charCode?(u({variables:{username:o,gid:f,content:O(n.current.input.value,"text",f),cType:"text"}}),n.current.clear(),e.preventDefault(),!1):void 0)},rightButtons:r.a.createElement(b.Button,{text:"Send",onClick:function(e){u({variables:{username:o,gid:f,content:O(n.current.value,"text",f),cType:"text"}}),n.current.clear(),e.preventDefault()}})})))))},he=n(186),Oe=n(4),je=n(187);var Ee=function(){var e=window.location.href.includes("https://rithik.me/"),t=e?"https://e2-chat.herokuapp.com":"http://localhost:4000",n=e?"wss://e2-chat.herokuapp.com":"ws://localhost:4000",a=localStorage.getItem("token"),o=Object(l.createHttpLink)({uri:"".concat(t,"/graphql")}),c=Object(he.a)((function(e,t){var n=t.headers;return{headers:Object(u.a)(Object(u.a)({},n),{},{authorization:a?"".concat(a):""})}})),i=new je.a({uri:"".concat(n,"/graphql"),options:{reconnect:!0,connectionParams:{Authorization:a}}}),s=Object(l.split)((function(e){var t=e.query,n=Object(Oe.p)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),i,c.concat(o)),m=new l.ApolloClient({link:s,cache:new l.InMemoryCache});return r.a.createElement(l.ApolloProvider,{client:m},r.a.createElement("div",null,r.a.createElement(ye,{client:m})))},we=n(733),Se=n(737),ke=n(738),Ke=n(736),Ie=n(735),Ce=n(262),$e=n.n(Ce),xe=n(408),Te=n(261),Me=n(734),Be=n(406),Ge=n(729);function Ae(){var e=Object(p.a)(["\n    mutation updateKeys($username: String!, $keys: String!){\n        updateKeys(username:$username, keys:$keys){\n            success\n        }\n    }\n"]);return Ae=function(){return e},e}function Ne(){var e=Object(p.a)(["\n\tquery User($username: String!){\n\t\tuser(username:$username){\n\t\t\tusername\n\t\t\tid\n\t\t\tkeys\n\t\t}\n\t}\n"]);return Ne=function(){return e},e}function Pe(){var e=Object(p.a)(["\n\tmutation CreateToken($username: String!, $publicKey: String!){\n\t\t  createToken(username:$username, publicKey:$publicKey){\n\t\t    token\n\t\t    username\n\t\t}\n\t}\n"]);return Pe=function(){return e},e}function qe(){var e=Object(p.a)(["\n\tmutation CreateUser($username: String!, $publicKey: String!){\n\t  createUser(username:$username, publicKey:$publicKey){\n\t    id\n\t    username\n\t    publicKey\n\t  }\n\t}\n"]);return qe=function(){return e},e}var Le=Object(Be.a)({overrides:{MuiFormLabel:{root:{color:"white",borderColor:"white"}},MuiOutlinedInput:{root:{"& $notchedOutline":{borderColor:"rgba(255, 255, 255, 0.23)"},"&:hover:not($disabled):not($focused):not($error) $notchedOutline":{borderColor:"#4A90E2","@media (hover: none)":{borderColor:"rgba(255, 255, 255, 0.23)"}},"&$focused $notchedOutline":{borderColor:"#4A90E2",borderWidth:1}}},MuiInput:{input:{"&::placeholder":{color:"gray"},color:"white"}}}}),Ue=Object(l.gql)(qe()),ze=Object(l.gql)(Pe()),De=Object(l.gql)(Ne()),Fe=Object(l.gql)(Ae());var Re=function(){var e=Object(l.useMutation)(Fe),t=Object(m.a)(e,1)[0],n=Object(l.useMutation)(Ue,{onCompleted:function(e){var t=e.createUser,n=t.username,a=t.publicKey;i({variables:{username:n,publicKey:a}})}}),o=Object(m.a)(n,1)[0],c=Object(l.useMutation)(ze,{onCompleted:function(e){var n=e.createToken,a="login"===D?K:y;localStorage.setItem("token",n.token),localStorage.setItem("username",n.username),localStorage.setItem("password",ae(a)),t({variables:{username:n.username,keys:re()}}),window.location.href=window.location.href+"main"}}),i=Object(m.a)(c,1)[0],s=Object(l.useMutation)(ze,{onCompleted:function(e){var t=e.createToken;localStorage.setItem("token",t.token),window.location.href=window.location.href+"main"}}),u=Object(m.a)(s,1)[0],p=Object(a.useState)(""),d=Object(m.a)(p,2),g=d[0],b=d[1],f=Object(a.useState)(""),v=Object(m.a)(f,2),y=v[0],h=v[1],O=Object(a.useState)(""),j=Object(m.a)(O,2),E=j[0],w=j[1],S=Object(a.useState)(""),k=Object(m.a)(S,2),K=k[0],I=k[1],C=Object(a.useState)(!1),$=Object(m.a)(C,2),x=$[0],T=$[1],M=Object(a.useState)(!1),B=Object(m.a)(M,2),G=B[0],A=B[1],N=Object(a.useState)(!1),P=Object(m.a)(N,2),q=P[0],L=P[1],U=Object(a.useState)("login"),z=Object(m.a)(U,2),D=z[0],F=z[1],R=Object(l.useQuery)(De,{variables:{username:"login"===D?E:g}}),H=R.error,Q=R.refetch,V=function(){var e=Object(J.a)(W.a.mark((function e(t){var n;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="login"===D?E:g,Promise.resolve(te(t,4096)).then((function(e){var t=e.publicKey,a=e.privateKey;o({variables:{username:n,publicKey:t}}),localStorage.setItem("user-publicKey",t),localStorage.setItem("user-privateKey",a),localStorage.setItem("username",n)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(J.a)(W.a.mark((function e(){var t,n;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q({username:g});case 2:t=e.sent,n=t.data,H?V(g):null==n.user?(T(!1),V(g)):(T(!0),L(!1));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(J.a)(W.a.mark((function e(){var t,n,a,r,o;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q({username:E});case 2:t=e.sent,n=t.data,console.log(n),H?(console.error(H),A(!0),L(!1)):null===n.user?(A(!0),L(!1)):(a=ae(K),oe(n.user.keys,a)?(r=localStorage.getItem("username"),o=localStorage.getItem("user-publicKey"),u({variables:{username:r,publicKey:o}})):(A(!0),L(!1)));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Ge.a,{theme:Le},r.a.createElement(xe.a,{fill:!0,id:"controlled-tab-example",className:"tabHeadings",activeKey:D,onSelect:function(e){return F(e)}},r.a.createElement(Te.a,{eventKey:"login",title:"Login"},r.a.createElement("div",{className:"register"},r.a.createElement(Se.a,{InputProps:{style:{color:"white"}},id:"outlined-basic",label:"Username",variant:"outlined",value:E,color:"secondary",fullWidth:!0,onChange:function(e){return w(e.target.value)}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Se.a,{InputProps:{style:{color:"white"}},id:"outlined-basic",label:"Password",variant:"outlined",value:K,type:"password",color:"secondary",fullWidth:!0,onChange:function(e){return I(e.target.value)}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(we.a,{disabled:q,onClick:function(e){e.preventDefault(),L(!0),X()},variant:"contained",color:"secondary"},q&&r.a.createElement(Me.a,{size:20,style:{color:"white",marginRight:"10px"}})," Login"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Ie.a,{in:G},r.a.createElement(ke.a,{action:r.a.createElement(Ke.a,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){A(!1)}},r.a.createElement($e.a,{fontSize:"inherit"})),variant:"filled",severity:"error"},"Invalid Login")))),r.a.createElement(Te.a,{eventKey:"register",title:"Register"},r.a.createElement("div",{className:"register"},r.a.createElement(Se.a,{InputProps:{style:{color:"white"}},id:"outlined-basic",label:"Username",variant:"outlined",value:g,color:"secondary",fullWidth:!0,onChange:function(e){return b(e.target.value)}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Se.a,{InputProps:{style:{color:"white"}},id:"outlined-basic",label:"Password",variant:"outlined",value:y,type:"password",color:"secondary",fullWidth:!0,onChange:function(e){return h(e.target.value)}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(we.a,{disabled:q,onClick:function(e){e.preventDefault(),L(!0),Y()},variant:"contained",color:"secondary"},q&&r.a.createElement(Me.a,{size:20,style:{color:"white",marginRight:"10px"}})," Register"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Ie.a,{in:x},r.a.createElement(ke.a,{action:r.a.createElement(Ke.a,{"aria-label":"close",color:"inherit",size:"small",onClick:function(){T(!1)}},r.a.createElement($e.a,{fontSize:"inherit"})),variant:"filled",severity:"error"},"Invalid username - choose a unique username"))))))};var He=function(){var e=window.location.href.includes("https://rithik.me/"),t=e?"https://e2-chat.herokuapp.com":"http://localhost:4000",n=e?"wss://e2-chat.herokuapp.com":"ws://localhost:4000",a=localStorage.getItem("token"),o=Object(l.createHttpLink)({uri:"".concat(t,"/graphql")}),c=Object(he.a)((function(e,t){var n=t.headers;return{headers:Object(u.a)(Object(u.a)({},n),{},{authorization:a?"".concat(a):""})}})),i=new je.a({uri:"".concat(n,"/graphql"),options:{reconnect:!0,connectionParams:{Authorization:a}}}),s=Object(l.split)((function(e){var t=e.query,n=Object(Oe.p)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),i,c.concat(o)),m=new l.ApolloClient({link:s,cache:new l.InMemoryCache});return r.a.createElement(l.ApolloProvider,{client:m},r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(Re,null))))};var We=function(){return r.a.createElement(i.a,{basename:"/"},r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/main"},r.a.createElement(Ee,null)),r.a.createElement(s.a,{path:"/"},r.a.createElement(He,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(We,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},86:function(e,t,n){}},[[419,1,2]]]);
//# sourceMappingURL=main.3726d611.chunk.js.map