{"version":3,"sources":["utils/AESEncryption.js","components/ChatLeftList.react.js","utils/files.js","components/ChatFeed.react.js","components/ChatMessages.react.js","utils/generateKeys.tsx","utils/localStorageKeyGen.ts","components/GroupChatTags.react.js","components/AddGroupMember.react.js","components/ChatMain.react.js","components/ChatMainApolloProvider.react.js","components/register.react.js","components/RegisterApolloProvider.react.js","App.tsx","serviceWorker.ts","index.tsx"],"names":["encryptMessage","message","type","groupId","messageJSON","messageString","JSON","stringify","groupPrivateKey","localStorage","getItem","CryptoJS","AES","encrypt","toString","decryptMessage","decrypt","parse","enc","Utf8","encryptMessageForPrivateKey","user","crypt","JSEncrypt","setPublicKey","publicKey","decryptMessageForPrivateKey","setPrivateKey","GET_GROUPS","gql","GROUP_SUBSCRIPTION","ChatLeftList","selectedGroup","setSelectedGroup","setDoneFetching","client","username","useQuery","variables","subscribeToMore","loading","error","data","refetch","useEffect","subscribe","document","updateQuery","prev","subscriptionData","newGroup","setItem","id","privateKey","Object","assign","groupsByUser","resetStore","stringToColor","groupName","hash","i","length","charCodeAt","color","substr","dataSource","map","group","users","letterItem","letter","name","charAt","toUpperCase","alt","title","subtitle","join","date","Date","unread","className","onClick","chat","style","backgroundColor","convertFileToBase64","event","createMessage","target","files","reader","FileReader","readAsDataURL","onload","e","cType","includes","filename","encryptFile","result","gid","content","css","ChatFeed","messages","onLoadMore","messagesEndRef","doneFetching","React","createRef","messagesStartRef","window","lm","scrollIntoView","behavior","interval","setInterval","top","getBoundingClientRect","innerHeight","clearInterval","messagebox","position","sender","text","senderName","parseInt","ts","uri","status","click","width","height","filter","Boolean","marginLeft","marginRight","marginBottom","ref","el","lockable","toBottomHeight","onDownload","dataurl","arr","split","mime","match","bstr","atob","n","u8arr","Uint8Array","file","File","saveAs","dataURLtoFile","float","clear","GET_MESSAGES","MESSAGE_SUBSCRIPTION","override","ChatMessages","useState","setMessages","offset","limit","fetchPolicy","fetchMore","messageObjects","concat","messagesByGroup","reverse","subscription","newFeedItem","newMessage","size","fetchMoreResult","futureMessages","ab2str","buf","String","fromCharCode","apply","Array","from","exportCryptoPublicKey","key","a","crypto","subtle","exportKey","exported","exportedAsString","exportedAsBase64","btoa","pemExported","exportCryptoPrivateKey","generateKeys","modulus","generateKey","modulusLength","publicExponent","then","keyPair","response","generatePasswordHash","password","pbkdf2","pbkdf2Sync","encryptLocalStorage","localStorageString","hashedPassword","setLocalStorage","localStorageDict","entries","value","console","CREATE_GROUP","SEND_MESSAGE","UPDATE_KEYS","GroupChatTags","show","setShow","tags","setTags","handleClose","setgroupName","useMutation","updateKeys","createPrivateKey","onCompleted","createGroup","removeItem","keys","Modal","transparent","onHide","Header","closeButton","borderColor","Title","Body","onChange","newTags","inputProps","placeholder","onlyUnique","Form","marginTop","Group","Control","testid","Footer","Button","variant","raw_tags","push","index","self","indexOf","Promise","resolve","array","createGroupChat","ADD_MEMBER_GROUP","AddGroupMember","addGroupMember","addToGroup","addMemberToGroup","themes","defaultTheme","FixedWrapperMaximized","boxShadow","OwnMessage","secondaryTextColor","purpleTheme","TextComposer","elegantTheme","Message","darkTheme","vars","TitleBar","padding","ChatMain","inputEl","useRef","fileUploader","showAdd","setShowAdd","theme","zIndex","overflowX","paddingTop","left","verticalAlign","fontSize","round","fullURL","location","href","pop","baseURL","right","borderLeft","styles","overflow","paddingLeft","bottom","defaultValue","multiline","onKeyPress","shiftKey","charCode","current","input","trim","preventDefault","rightButtons","display","newValue","ChatMainApolloProvider","PRODUCTION","serverURL","wsURL","token","httpLink","createHttpLink","authLink","setContext","_","headers","authorization","wsLink","WebSocketLink","options","reconnect","connectionParams","Authorization","splitLink","query","definition","getMainDefinition","kind","operation","ApolloClient","link","cache","InMemoryCache","customTheme","createMuiTheme","overrides","MuiFormLabel","root","MuiOutlinedInput","borderWidth","MuiInput","CREATE_USER","CREATE_TOKEN","GET_USER","Register","createUser","createToken","tab","loginPassword","registerPassword","createLoginToken","registerUsername","setRegisterUsername","setRegisterPassword","loginUsername","setLoginUsername","setLoginPassword","registerUsernameError","setRegisterUsernameError","loginError","setLoginError","buttonPressed","setButtonPressed","setTab","setKeys","myUsernameValue","registerUser","userData","loginUser","ThemeProvider","Tabs","fill","activeKey","onSelect","k","Tab","eventKey","TextField","InputProps","label","fullWidth","disabled","CircularProgress","Collapse","in","Alert","action","IconButton","aria-label","severity","RegisterApolloProvider","App","basename","path","hostname","ReactDOM","render","Fragment","getElementById","navigator","serviceWorker","ready","registration","unregister","catch"],"mappings":"8kBAGO,SAASA,EAAeC,EAASC,EAAMC,GAC1C,IAAIC,EAAc,CAAC,QAAWH,EAAS,KAAOC,GAC1CG,EAAgBC,KAAKC,UAAUH,GAC7BI,EAAkBC,aAAaC,QAAb,UAAwBP,EAAxB,gBAExB,OADkBQ,IAASC,IAAIC,QAAQR,EAAeG,GAAiBM,WAIpE,SAASC,EAAed,EAASE,GACpC,IAAMK,EAAkBC,aAAaC,QAAb,UAAwBP,EAAxB,gBAClBa,EAAUL,IAASC,IAAII,QAAQf,EAASO,GAC9C,OAAOF,KAAKW,MAAMD,EAAQF,SAASH,IAASO,IAAIC,OAG7C,SAASC,EAA4BnB,EAASoB,GACjD,IAAIC,EAAQ,IAAIC,IAGhB,OAFAD,EAAME,aAAaH,EAAKI,WACNH,EAAMT,QAAQZ,GAI7B,SAASyB,EAA4BzB,GACxC,IAAIqB,EAAQ,IAAIC,IAGhB,OAFAD,EAAMK,cAAclB,aAAaC,QAAQ,oBACvBY,EAAMN,QAAQf,G,ijBCbpC,IAAM2B,EAAaC,cAAH,KAaVC,EAAqBD,cAAH,KA6FTE,MA/Ef,YAAqF,IAA7DC,EAA4D,EAA5DA,cAAeC,EAA6C,EAA7CA,iBAAkBC,EAA2B,EAA3BA,gBAAiBC,EAAU,EAAVA,OAClEC,EAAW3B,aAAaC,QAAQ,YAD4C,EAS9E2B,mBAAST,EAAY,CACvBU,UAAW,CACTF,cAPFG,EAJgF,EAIhFA,gBACAC,EALgF,EAKhFA,QACAC,EANgF,EAMhFA,MACAC,EAPgF,EAOhFA,KACAC,EARgF,EAQhFA,QA0BF,GAnBAC,qBAAU,WACR,IAAMC,EAAYN,EAAgB,CAChCO,SAAUhB,EACVQ,UAAW,CAAEF,YACbW,YAAa,SAACC,EAAD,GAAiC,IAAxBC,EAAuB,EAAvBA,iBACpB,IAAKA,EAAiBP,KAAM,OAAOM,EACnC,IAAME,EAAWD,EAAiBP,KAAKQ,SAEvC,OADAzC,aAAa0C,QAAb,UAAwBD,EAASE,GAAjC,eAAkD1B,EAA4BwB,EAASG,aAChFC,OAAOC,OAAO,GAAIP,EAAM,CAC7BQ,aAAa,CAAEN,GAAH,mBAAgBF,EAAKQ,oBAIvC,OAAO,WACLX,OAED,CAACN,EAAiBH,IAGjBI,EAAS,MAAO,aACpB,GAAIC,EAGF,OAFAN,EAAOsB,aACPd,IACM,UAAN,OAAiBF,EAAMxC,SAGzB,IAAMyD,EAAgB,SAACC,GAErB,IADA,IAAIC,EAAO,EACFC,EAAI,EAAGA,EAAIF,EAAUG,OAAQD,IACpCD,EAAOD,EAAUI,WAAWF,KAAOD,GAAQ,GAAKA,GAElD,IAAII,EAAQ,IACZ,IAASH,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAE1BG,IAAU,MADGJ,GAAa,EAAJC,EAAU,KACT/C,SAAS,KAAKmD,QAAQ,GAE/C,OAAOD,GAGHE,EAAaxB,EAAKc,aAAaW,KAAI,SAAAC,GACe,MAAlD3D,aAAaC,QAAb,UAAwB0D,EAAMhB,GAA9B,iBAA6G,cAAnD3C,aAAaC,QAAb,UAAwB0D,EAAMhB,GAA9B,iBAC5D3C,aAAa0C,QAAb,UAAwBiB,EAAMhB,GAA9B,eAA+C1B,EAA4B0C,EAAMf,aAEnF,IAAMgB,EAAQD,EAAMC,MAAMF,KAAI,SAAA9C,GAAI,iBAAQA,EAAKe,aAC/C,MAAO,CACLkC,WAAY,CAAEC,OAAQH,EAAMI,KAAKC,OAAO,GAAGC,cAAetB,GAAIM,EAAcU,EAAMI,OAClFG,IAAKP,EAAMI,KACXI,MAAOR,EAAMI,KACbK,SAAUR,EAAMS,KAAK,MACrBC,KAAM,IAAIC,KACVC,OAAQ,EACR7B,GAAIgB,EAAMhB,GACV8B,UAAWlD,IAAkBoC,EAAMhB,GAAK,iBAAmB,wBAK/D,OAAQ,kBAAC,WAAD,CAAU+B,QAAS,SAACC,GAAWnD,EAAiBmD,EAAKhC,IAAKlB,GAAgB,IAChFmD,MAAO,CACLC,gBAAiB,WAEnBpB,WAAYA,K,oDCnGHqB,EAAsB,SAACC,EAAOrF,EAASsF,EAAerD,GAC/D,GAA0B,MAAtBoD,EAAME,OAAOC,MAAjB,CAGA,IAAMC,EAAS,IAAIC,WACnBD,EAAOE,cAAcN,EAAME,OAAOC,MAAM,IACxCC,EAAOG,OAAS,SAASC,GACrB,IAAMC,EAAUT,EAAME,OAAOC,MAAM,GAAGzF,KAAKgG,SAAS,UAAa,QAAU,OAErEjG,EAKP,SAAqBA,EAASkG,EAAUhG,GAC3C,IAAIC,EAAc,CAAC,QAAWH,EAAS,SAAYkG,GAC/C9F,EAAgBC,KAAKC,UAAUH,GAC7BI,EAAkBC,aAAaC,QAAb,UAAwBP,EAAxB,gBAExB,OADkBQ,IAASC,IAAIC,QAAQR,EAAeG,GAAiBM,WATnDsF,CADHR,EAAOS,OACgBb,EAAME,OAAOC,MAAM,GAAGnB,KAAMrE,GAChEsF,EAAc,CAAEnD,UAAW,CAAEF,WAAUkE,IAAKnG,EAASoG,QAAStG,EAASgG,c,mIClB9DO,cAAH,KAgHCC,MA1Gf,YAKI,IAJAC,EAID,EAJCA,SACAC,EAGD,EAHCA,WAIIC,GADL,EAFCC,aAED,EADC7E,cAEqB8E,IAAMC,aACvBC,EAAmBF,IAAMC,YAE7BE,OAAOC,GAAKP,EAEZ/D,qBAAU,WACNgE,EAAeO,eAAe,CAAEC,SAAU,WAC1C,IAAMC,EAAWC,aAAY,WAEzB,IAAKN,EAAkB,OAAO,EAC9B,IAAMO,EAAMP,EAAiBQ,wBAAwBD,IACrCA,EAHD,GAGkB,GAAuBN,OAAOQ,cAIhE,KACH,OAAO,WACHC,cAAcL,MAEnB,CAACV,EAAYK,EAAkBJ,IAEnBK,OAAOQ,YAAtB,IACMrF,EAAW3B,aAAaC,QAAQ,YAChCwD,EAAawC,EAASvC,KAAI,SAAAwD,GAC5B,MAAyB,SAArBA,EAAW1B,MACJ,CACH2B,SAAUD,EAAWE,SAAWzF,EAAW,QAAU,OACrDlC,KAAM,OACN4H,KAAMH,EAAW1H,QAAQA,QACzB2E,MAAO+C,EAAWI,WAClBhD,KAAM,IAAIC,KAAKgD,SAASL,EAAWM,MAGlB,UAArBN,EAAW1B,MACJ,CACH2B,SAAUD,EAAWE,SAAWzF,EAAW,QAAU,OACrDlC,KAAM,QACN0E,MAAO+C,EAAWI,WAClBhD,KAAM,IAAIC,KAAKgD,SAASL,EAAWM,KACnCvF,KAAM,CACFwF,IAAKP,EAAW1H,QAAQsG,QACxBJ,SAAUwB,EAAW1H,QAAQkG,SAC7BgC,OAAQ,CACJC,OAAO,EACP5F,QAAS,GAEb6F,MAAO,QACPC,OAAQ,UAIK,SAArBX,EAAW1B,MACJ,CACH2B,SAAUD,EAAWE,SAAWzF,EAAW,QAAU,OACrDlC,KAAM,OACN4H,KAAMH,EAAW1H,QAAQkG,SACzBvB,MAAO+C,EAAWI,WAClBhD,KAAM,IAAIC,KAAKgD,SAASL,EAAWM,KACnCvF,KAAM,CACFwF,IAAKP,EAAW1H,QAAQsG,QACxB4B,OAAQ,CACJC,OAAO,EACP5F,QAAS,KAKlB,QACR+F,OAAOC,SAEV,OAAO,yBAAKnD,MAAO,CAAEoD,WAAY,EAAGC,YAAa,EAAGC,aAAc,KAE9D,yBAAKtD,MAAO,CAAEiD,OAAQ,IAClBM,IAAK,SAACC,GAAS7B,EAAmB6B,KAUtC,yBAAKxD,MAAO,IACR,kBAAC,cAAD,CACIH,UAAU,eACV4D,UAAU,EACVC,eAAgB,MAChBC,WAAY,SAAChD,IDtEtB,SAAuBiD,EAAS9C,GAMnC,IALA,IAAI+C,EAAMD,EAAQE,MAAM,KACpBC,EAAOF,EAAI,GAAGG,MAAM,WAAW,GAC/BC,EAAOC,KAAKL,EAAI,IAChBM,EAAIF,EAAKxF,OACT2F,EAAQ,IAAIC,WAAWF,GACrBA,KACFC,EAAMD,GAAKF,EAAKvF,WAAWyF,GAE/B,IAAMG,EAAO,IAAIC,KAAK,CAACH,GAAQtD,EAAU,CAACjG,KAAKkJ,IAC/CS,iBAAOF,EAAMxD,GC6DG2D,CAAc9D,EAAEtD,KAAKwF,IAAgB,UAAXlC,EAAE9F,KAAmB8F,EAAEtD,KAAKyD,SAAWH,EAAE8B,OAEvE5D,WAAYA,KAGpB,yBAAKmB,MAAO,CAAE0E,MAAO,OAAQC,MAAO,QAChCpB,IAAK,SAACC,GAASjC,EAAiBiC,O,8uBCzG5C,IAAMoB,EAAepI,cAAH,KAaZqI,EAAuBrI,cAAH,KAapBsI,EAAW3D,cAAH,KAkGC4D,MA5Ff,YAEI,IADApI,EACD,EADCA,cAAe6E,EAChB,EADgBA,aAAc3E,EAC9B,EAD8BA,gBAC9B,EACiCmI,mBAAS,IAD1C,mBACQ3D,EADR,KACkB4D,EADlB,OAE8DjI,mBACzD4H,EACA,CACI3H,UAAW,CACPgE,IAAKtE,EACLuI,OAAQ,EACRC,MAAO,IAEXC,YAAa,YARblI,EAFT,EAESA,gBAAiBC,EAF1B,EAE0BA,QAASC,EAFnC,EAEmCA,MAAOC,EAF1C,EAE0CA,KAAMgI,EAFhD,EAEgDA,UA6C/C,OAjCA9H,qBAAU,WACWnC,aAAaC,QAAQ,YACtC,GAAIgC,EAAM,CACN,IACMiI,EADkB,GAAGC,OAAOlI,EAAKmI,iBAAiBC,UACjB3G,KAAI,SAAAlE,GACvC,OAA2D,MAAvDQ,aAAaC,QAAb,UAAwBsB,EAAxB,iBAAuH,cAAxDvB,aAAaC,QAAb,UAAwBsB,EAAxB,gBACxD,KAEJ,CAAE6F,OAAQ5H,EAAQ4H,OAAQ5H,QAASc,EAAed,EAAQsG,QAASvE,GAAgB+F,WAAW,IAAD,OAAM9H,EAAQ4H,QAAU5B,MAAOhG,EAAQgG,MAAOgC,GAAIhI,EAAQgI,OAC/JM,OAAOC,SACV8B,EAAYK,GAEhB,IAAMI,EAAexI,EAAgB,CACjCO,SAAUoH,EACV5H,UAAW,CAAEgE,IAAKtE,GAClBe,YAAa,SAACC,EAAD,GAAiC,IAAxBC,EAAuB,EAAvBA,iBAClB,IAAKA,EAAiBP,KAElB,OADAR,GAAgB,GACTc,EAEX,IAAMgI,EAAc/H,EAAiBP,KAAKuI,WACpCA,EAAa,CAAEpD,OAAQmD,EAAYnD,OAAQ5H,QAASc,EAAeiK,EAAYzE,QAASvE,GAAgB+F,WAAW,IAAD,OAAMiD,EAAYnD,QAAU5B,MAAO+E,EAAY/E,MAAOgC,GAAI+C,EAAY/C,IAE9L,OADAqC,GAAY,SAAA5D,GAAQ,4BAAQA,GAAR,CAAkBuE,OAC/B3H,OAAOC,OAAO,GAAIP,EAAM,CAC3B6H,gBAAgB,CAAEG,GAAH,mBAAmBhI,EAAK6H,uBAInD,OAAO,WACHE,OAEL,CAACxI,EAAiBP,EAAeU,IAEhCF,EAAiB,yBAAK6C,MAAO,CAAEoD,WAAY,OAAQC,YAAa,OAAQC,aAAc,SACtF,yBAAKtD,MAAO,CAAEiD,OAAQ,UAEbzB,GAAgB,kBAAC,IAAD,CACbL,IAAK2D,EACLe,KAAM,GACNlH,MAAO,UACPxB,SAAS,MAKrBC,EAAa,UAAN,OAAiBA,EAAMxC,SAC3B,kBAAC,EAAD,CAAUyG,SAAUA,EAAU1E,cAAeA,EAAe6E,aAAcA,EAAcF,WAAY,WACvG,IAAIE,EAGJ,OAAO6D,EAAU,CACbpI,UAAW,CACPiI,OAAQ7H,EAAKmI,gBAAgB/G,QAEjCf,YAAa,SAACC,EAAD,GAAgC,IAAvBmI,EAAsB,EAAtBA,gBAC6B,IAA3CA,EAAgBN,gBAAgB/G,QAChC5B,GAAgB,GAEpB,IAAMkJ,EAAiBD,EAAgBN,gBAEjCF,GADWlK,aAAaC,QAAQ,YACf0K,EAAejH,KAAI,SAAAlE,GACtC,OAA2D,MAAvDQ,aAAaC,QAAb,UAAwBsB,EAAxB,iBAAuH,cAAxDvB,aAAaC,QAAb,UAAwBsB,EAAxB,gBACxD,KAEJ,CAAE6F,OAAQ5H,EAAQ4H,OAAQ5H,QAASc,EAAed,EAAQsG,QAASvE,GAAgB+F,WAAW,IAAD,OAAM9H,EAAQ4H,QAAU5B,MAAOhG,EAAQgG,MAAOgC,GAAIhI,EAAQgI,OAC/JM,OAAOC,UAEV,OADA8B,GAAY,SAAA5D,GAAQ,4BAAQA,GAAR,YAAqBiE,OAClCrH,OAAOC,OAAO,GAAIP,EAAM,CAC3B6H,gBAAgB,GAAD,mBAAM7H,EAAK6H,iBAAX,YAA+BM,EAAgBN,2B,+FC7HlF,SAASQ,EAAOC,GACZ,OAAOC,OAAOC,aAAaC,MAAM,KAAMC,MAAMC,KAAK,IAAIjC,WAAW4B,K,SAGtDM,E,iFAAf,WAAqCC,GAArC,qBAAAC,EAAA,sEAC2B7E,OAAO8E,OAAOC,OAAOC,UACxC,OACAJ,GAHR,cACUK,EADV,OAKUC,EAAmBd,EAAOa,GAC1BE,EAAmBnF,OAAOoF,KAAKF,GAC/BG,EAPV,sCAOuDF,EAPvD,gDAQWE,GARX,4C,+BAWeC,G,iFAAf,WAAsCV,GAAtC,qBAAAC,EAAA,sEAC2B7E,OAAO8E,OAAOC,OAAOC,UACxC,QACAJ,GAHR,cACUK,EADV,OAKUC,EAAmBd,EAAOa,GAC1BE,EAAmBnF,OAAOoF,KAAKF,GAC/BG,EAPV,uCAOwDF,EAPxD,iDAQWE,GARX,4C,sBAYO,SAAeE,GAAtB,qC,8CAAO,WAA4BpK,EAAkBqK,GAA9C,eAAAX,EAAA,sEACoB7E,OAAO8E,OAAOC,OAAOU,YAAY,CACpDlI,KAAM,WACNmI,cAAeF,EACfG,eAAgB,IAAIlD,WAAW,CAAC,EAAG,EAAG,IACtC9F,KAAM,YAEN,EACA,CAAC,UAAW,YACdiJ,KARqB,uCAQhB,WAAOC,GAAP,iBAAAhB,EAAA,sEACqBF,EAAsBkB,EAAQrL,WADnD,cACGA,EADH,gBAEsB8K,GAAuBO,EAAQzJ,YAFrD,cAEGA,EAFH,yBAGI,CACHA,aACAjB,WACAX,cAND,2CARgB,uDADpB,cACGsL,EADH,yBAkBIA,GAlBJ,4C,sBAsBA,SAASC,GAAqBC,GAEjC,OADiBC,IAAOC,WAAWF,EAAU,OAAQ,EAAG,GAAI,UAAUnM,SAAS,OCnD5E,SAASsM,KACZ,IAAMC,EAAqB/M,KAAKC,UAAUE,cACpC6M,EAAyB7M,aAAaC,QAAQ,aAAe,GAEnE,OADkBC,IAASC,IAAIC,QAAQwM,EAAoBC,GAAgBxM,WAIxE,SAASyM,GAAgBF,EAA4BC,GACxD,IAAMtM,EAAUL,IAASC,IAAII,QAAQqM,EAAoBC,GACzD,IAEI,IADA,IAAME,EAAmBlN,KAAKW,MAAMD,EAAQF,SAASH,IAASO,IAAIC,OAClE,MAA2BmC,OAAOmK,QAAQD,GAA1C,eAA6D,CAAC,IAAD,sBAAjD3B,EAAiD,KAA5C6B,EAA4C,KACzDjN,aAAa0C,QAAQ0I,EAAM6B,IAGnC,MAAM1H,GAEF,OADA2H,QAAQlL,MAAMuD,IACP,EAEX,OAAO,E,i3BCRX,IAAM4H,GAAe/L,cAAH,MAcZgM,GAAehM,cAAH,MASZiM,GAAcjM,cAAH,MA4EFkM,OApEf,YAA2C,IAAlBC,EAAiB,EAAjBA,KAAMC,EAAW,EAAXA,QAAW,EACd5D,mBAAS,IADK,mBAC/B6D,EAD+B,KACzBC,EADyB,KAGhCC,EAAc,kBAAMH,GAAQ,IAHI,EAIJ5D,mBAAS,IAJL,mBAI/B1G,EAJ+B,KAIpB0K,EAJoB,OAKjBC,sBAAYR,IAA1BS,EAL+B,sBAMXD,sBAAYT,IAAhCW,EAN+B,sBAOhBF,sBAAYV,GAAc,CAC5Ca,YAD4C,YACd,IAAhBC,EAAe,EAAfA,YACJtM,EAAW3B,aAAaC,QAAQ,YAChC2C,EAAa5C,aAAaC,QAAQ,yBACxCD,aAAa0C,QAAb,UAAwBuL,EAAYtL,GAApC,eAAqDC,GACrD5C,aAAakO,WAAW,yBACxBD,EAAYrK,MAAMF,KAAI,SAAA9C,GAClB,IAAMkF,EAAUnF,EAA4BiC,EAAYhC,GAExD,OADAmN,EAAiB,CAAElM,UAAW,CAAEF,SAAUf,EAAKe,SAAUkE,IAAKoI,EAAYtL,GAAIC,WAAYkD,MACnF,KAEXgI,EAAW,CAACjM,UAAW,CAACF,WAAUwM,KAAMxB,QACxCgB,OAZDM,EAP+B,oBAuCtC,OACI,yBAAKrJ,MAAO,CAACC,gBAAiB,YAC1B,kBAACuJ,GAAA,EAAD,CAAOb,KAAMA,EAAMc,YAAa,OAAQC,OAAQX,GAC5C,kBAACS,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAC5J,MAAO,CAACC,gBAAiB,UAAW4J,YAAa,YACvE,kBAACL,GAAA,EAAMM,MAAP,8DAGJ,kBAACN,GAAA,EAAMO,KAAP,CAAY/J,MAAO,CAACC,gBAAiB,UAAW4J,YAAa,YACzD,kBAAC,IAAD,CAAW7J,MAAO,CAACrB,MAAO,SAAU0J,MAAOQ,EAAMmB,SAAU,SAACC,GAAD,OAAanB,EAAQmB,IAAUC,WAAY,CAClGrK,UAAW,wBACXsK,YAAa,eACdC,YAAU,IACb,kBAACC,GAAA,EAAD,CAAMrK,MAAO,CAACsK,UAAW,SACrB,kBAACD,GAAA,EAAKE,MAAN,KACI,kBAACF,GAAA,EAAKG,QAAN,CAAcC,OAAQ,wBAAyBzK,MAAO,CAACrB,MAAO,SAAU9D,KAAK,OAAOsP,YAAY,aAAa9B,MAAO/J,EAAW0L,SAAU,SAACrJ,GAAD,OAAOqI,EAAarI,EAAEN,OAAOgI,aAIlL,kBAACmB,GAAA,EAAMkB,OAAP,CAAc1K,MAAO,CAACC,gBAAiB,UAAW4J,YAAa,YAC3D,kBAACc,EAAA,EAAD,CAAQC,QAAQ,YAAY9K,QAASiJ,GAArC,SAGI,kBAAC4B,EAAA,EAAD,CAAQC,QAAQ,UAAU9K,QAAS,kBAtC/B,SAAC+K,EAAUvM,GAC/BuM,EAASC,KAAK1P,aAAaC,QAAQ,aAInC,IAAIwN,EAAOgC,EAAS3H,QAHpB,SAAoBmF,EAAO0C,EAAOC,GAC9B,OAAOA,EAAKC,QAAQ5C,KAAW0C,KAG/BlC,GAAQA,EAAKpK,OAAS,GACtByM,QAAQC,QAAQhE,GAAa7I,EAAW,MAAMkJ,MAAK,SAAU4D,GACzD,IAAMhP,EAAYgP,EAAMhP,UAClB4B,EAAaoN,EAAMpN,WACzB5C,aAAa0C,QAAQ,wBAAyBE,GAC9CqL,EAAY,CAAEpM,UAAW,CAAE+B,MAAO6J,EAAMzM,UAAWA,EAAW+C,KAAMb,QA2BnB+M,CAAgBxC,EAAMvK,KAA/D,qB,izBC5FxB,IAAMgN,GAAmB9O,cAAH,MAchBgM,GAAehM,cAAH,MASZiM,GAAcjM,cAAH,MA+DF+O,OAvDf,YAAqD,IAA3B5C,EAA0B,EAA1BA,KAAMC,EAAoB,EAApBA,QAAS9N,EAAW,EAAXA,QAAW,EACxBkK,mBAAS,IADe,mBACzC6D,EADyC,KACnCC,EADmC,KAG1CC,EAAc,kBAAMH,GAAQ,IAHc,EAId5D,mBAAS,IAJK,gCAK3BiE,sBAAYR,KAA1BS,EALyC,sBAMrBD,sBAAYT,IAAhCW,EANyC,sBAO3BF,sBAAYqC,GAAkB,CAC/ClC,YAD+C,YAChB,IAAlBoC,EAAiB,EAAjBA,eACHzO,EAAW3B,aAAaC,QAAQ,YAChC2C,EAAa5C,aAAaC,QAAb,UAAwBmQ,EAAezN,GAAvC,gBACnByN,EAAexM,MAAMF,KAAI,SAAA9C,GACrB,IAAMkF,EAAUnF,EAA4BiC,EAAYhC,GAExD,OADAmN,EAAiB,CAAElM,UAAW,CAAEF,SAAUf,EAAKe,SAAUkE,IAAKuK,EAAezN,GAAIC,WAAYkD,MACtF,KAEXgI,EAAW,CAACjM,UAAW,CAACF,WAAUwM,KAAMxB,QACxCgB,OAVD0C,EAPyC,oBA+BhD,OACI,yBAAKzL,MAAO,CAACC,gBAAiB,YAC1B,kBAACuJ,GAAA,EAAD,CAAOb,KAAMA,EAAMc,YAAa,OAAQC,OAAQX,GAC5C,kBAACS,GAAA,EAAMG,OAAP,CAAcC,aAAW,EAAC5J,MAAO,CAACC,gBAAiB,UAAW4J,YAAa,YACvE,kBAACL,GAAA,EAAMM,MAAP,0DAGJ,kBAACN,GAAA,EAAMO,KAAP,CAAY/J,MAAO,CAACC,gBAAiB,UAAW4J,YAAa,YACzD,kBAAC,IAAD,CAAW7J,MAAO,CAACrB,MAAO,SAAU0J,MAAOQ,EAAMmB,SAAU,SAACC,GAAD,OAAanB,EAAQmB,IAAUC,WAAY,CAClGrK,UAAW,wBACXsK,YAAa,eACdC,YAAU,KAEjB,kBAACZ,GAAA,EAAMkB,OAAP,CAAc1K,MAAO,CAACC,gBAAiB,UAAW4J,YAAa,YAC3D,kBAACc,EAAA,EAAD,CAAQC,QAAQ,YAAY9K,QAASiJ,GAArC,SAGI,kBAAC4B,EAAA,EAAD,CAAQC,QAAQ,UAAU9K,QAAS,kBA3B9B,SAAC+K,GAItB,IAAIhC,EAAOgC,EAAS3H,QAHpB,SAAoBmF,EAAO0C,EAAOC,GAC9B,OAAOA,EAAKC,QAAQ5C,KAAW0C,KAG/BlC,GAAQA,EAAKpK,OAAS,GACtBgN,EAAW,CAAExO,UAAW,CAAE+B,MAAO6J,EAAM5H,IAAK0B,SAAS7H,MAqBA4Q,CAAiB7C,KAA1D,oB,qUCzExB,IAAML,GAAehM,cAAH,MASZmP,GAAS,CACXC,aAAc,CACVC,sBAAuB,CACnB1K,IAAK,CACD2K,UAAW,+BAGnBC,WAAW,2BACJH,IAAaG,YADV,IAEN9L,gBAAiB,UACjB+L,mBAAoB,aAG5BC,YAAY,2BACLA,KADI,IAEPC,aAAa,2BACND,IAAYC,cADP,IAER/K,IAAI,2BACG8K,IAAYC,aAAa/K,KAD7B,IAECmJ,UAAW,UAGnByB,WAAW,2BACJE,IAAYF,YADT,IAENC,mBAAoB,WAG5BG,aAAa,2BACNA,KADK,IAERC,QAAQ,2BACDC,IAAUD,SADV,IAEHJ,mBAAoB,SAExBD,WAAW,2BACJM,IAAUN,YADP,IAENC,mBAAoB,WAG5BK,UAAU,2BACHA,KADE,IAELC,KAAK,2BACED,IAAUC,MADb,IAEA,iBAAkB,0BAEtBF,QAAQ,2BACDC,IAAUD,SADV,IAEHjL,IAAI,2BACGkL,IAAUD,QAAQjL,KADtB,IAECxC,MAAO,WAGfoN,WAAW,2BACJM,IAAUN,YADP,IAENC,mBAAoB,SAExBO,SAAS,2BACFF,IAAUE,UADT,IAEJpL,IAAI,2BACGkL,IAAUE,SAASpL,KADvB,IAECqL,QAAS,aA8HVC,OAxHf,YAA+B,IAAX3P,EAAU,EAAVA,OACV4P,EAAUC,iBAAO,MACjBC,EAAeD,iBAAO,MACtB5P,EAAW3B,aAAaC,QAAQ,YAHZ,EAIc2J,mBAAS,IAJvB,gCAKFiE,sBAAYT,KAA7BpI,EALmB,sBAOgB4E,mBAAS,MAPzB,mBAOnBrI,EAPmB,KAOJC,EAPI,OAQcoI,oBAAS,GARvB,mBAQnBxD,EARmB,KAQL3E,EARK,OASFmI,oBAAS,GATP,mBASnB2D,EATmB,KASbC,EATa,OAUI5D,oBAAS,GAVb,mBAUnB6H,EAVmB,KAUVC,EAVU,KAqB1B,OAAQ,yBAAKjN,UAAU,QACnB,kBAAC,GAAD,CAAe8I,KAAMA,EAAMC,QAASA,IACpC,kBAAC,GAAD,CAAgBD,KAAMkE,EAASjE,QAASkE,EAAYhS,QAAS6B,IAC7D,kBAAC,IAAD,CAAeoQ,MAAOpB,GAAOU,WACzB,yBAAKrM,MAAO,CACRiD,OAAQ,OACRD,MAAO,MACPT,SAAU,QACVyK,OAAQ,EACR9K,IAAK,EACL+K,UAAW,SACXC,WAAY,OACZC,KAAM,IAEN,yBAAKnN,MAAO,CAAEoN,cAAe,SAAUC,SAAU,KAC7C,kBAAC,IAAD,CAAQlO,KAAMpC,EAAU8I,KAAM,GAAIyH,OAAK,EAACtN,MAAO,CAAEsD,aAAc,GAAIF,WAAY,IAAM7D,MAAK,WAAMxC,KADpG,eACwHA,IAExH,yBAAK8C,UAAU,MAAMG,MAAO,CAAEsD,aAAc,KACvC3G,GAAiB,kBAACgO,EAAA,EAAD,CAAQC,QAAQ,UAAU5K,MAAO,CAAEqD,YAAa,QAAUvD,QAAS,kBAAMgN,GAAYD,KAArF,sBAClB,kBAAClC,EAAA,EAAD,CAAQC,QAAQ,UAAU5K,MAAO,CAAEqD,YAAa,QAAUvD,QAAS,kBAAM8I,GAASD,KAAlF,qBACA,kBAACgC,EAAA,EAAD,CAAQC,QAAQ,YAAY9K,QA5B7B,WACX1E,aAAauJ,QACb,IAAI4I,EAAU3L,OAAO4L,SAASC,KAAK3J,MAAM,KACzCyJ,EAAQG,MACR,IAAMC,EAAUJ,EAAQ9N,KAAK,KAC7BmC,OAAO4L,SAASC,KAAOE,IAuBX,WAEJ,kBAAC,EAAD,CAAc7Q,OAAQA,EAAQH,cAAeA,EAAeC,iBAAkBA,EAAkBC,gBAAiBA,KAIrH,yBAAKmD,MAAO,CACRiD,OAAQ,OACRD,MAAO,MACPT,SAAU,QACVyK,OAAQ,EACR9K,IAAK,EACL+K,UAAW,SACXW,MAAO,EACPC,WAAY,oBAGRlR,GACI,oCACA,yBAAKmR,OAAQ,CAACC,SAAS,WACnB,yBAAK/N,MAAS,CAACiD,OAAO,MAAOV,SAAS,aAClC,kBAAC,EAAD,CAAc5F,cAAeA,EAAe6E,aAAcA,EAAc3E,gBAAiBA,KAE7F,yBAAKmD,MAAS,CAACgO,YAAa,MAAO/K,OAAO,KAAMgL,OAAO,KAAM1L,SAAS,QAASS,MAAM,QACjF,kBAAC,QAAD,CACImH,YAAY,gBACZ+D,aAAa,GACb3K,IAAKmJ,EACLyB,WAAW,EAKXC,WAAY,SAACzN,GACT,SAAIA,EAAE0N,UAA2B,KAAf1N,EAAE2N,YAGD,KAAf3N,EAAE2N,UAAwD,KAArC5B,EAAQ6B,QAAQC,MAAMnG,MAAMoG,QACjDrO,EAAc,CAAEnD,UAAW,CAAEF,WAAUkE,IAAKtE,EAAeuE,QAASvG,EAAe+R,EAAQ6B,QAAQC,MAAMnG,MAAO,OAAQ1L,GAAgBiE,MAAO,UAC/I8L,EAAQ6B,QAAQ5J,QAChBhE,EAAE+N,kBACK,QAJX,IAOJC,aACI,oCACI,2BACI5Q,GAAG,qBACHiC,MAAS,CAAC4O,QAAQ,QAClB/T,KAAK,OACL0I,IAAKqJ,EACL5C,SAAU,SAAC7J,EAAO0O,GACd3O,EAAoBC,EAAOxD,EAAeyD,EAAerD,GAEzDoD,EAAMuO,oBAGlB,kBAAC,SAAD,CAAYjM,KAAK,SAAS3C,QAAS,WAAK8M,EAAa2B,QAAQxL,WAE7D,kBAAC,SAAD,CACAN,KAAK,OACL3C,QAAS,SAACa,GACkC,KAArC+L,EAAQ6B,QAAQC,MAAMnG,MAAMoG,SAC3BrO,EAAc,CAAEnD,UAAW,CAAEF,WAAUkE,IAAKtE,EAAeuE,QAASvG,EAAe+R,EAAQ6B,QAAQC,MAAMnG,MAAO,OAAQ1L,GAAgBiE,MAAO,UAC/I8L,EAAQ6B,QAAQ5J,QAChBhE,EAAE+N,+B,4BC1InCI,OApDf,WACI,IAAMC,EAAanN,OAAO4L,SAASC,KAAK5M,SAAS,sBAC3CmO,EAAYD,EAAa,gCAAkC,wBAC3DE,EAAQF,EAAa,8BAAgC,sBACrDG,EAAQ9T,aAAaC,QAAQ,SAC7B8T,EAAWC,yBAAe,CAC5BvM,IAAI,GAAD,OAAKmM,EAAL,cAGDK,EAAWC,cAAW,SAACC,EAAD,GAAqB,IAAfC,EAAc,EAAdA,QAC9B,MAAO,CACHA,QAAQ,2BACDA,GADA,IAEHC,cAAeP,EAAK,UAAMA,GAAU,SAK1CQ,EAAS,IAAIC,KAAc,CAC7B9M,IAAI,GAAD,OAAKoM,EAAL,YACHW,QAAS,CACLC,WAAW,EACXC,iBAAkB,CACdC,cAAeb,MAKrBc,EAAYlM,iBACd,YAAgB,IAAbmM,EAAY,EAAZA,MACOC,EAAaC,aAAkBF,GACrC,MACwB,wBAApBC,EAAWE,MACc,iBAAzBF,EAAWG,YAGnBX,EACAL,EAAS9J,OAAO4J,IAGdrS,EAAS,IAAIwT,eAAa,CAC5BC,KAAMP,EACNQ,MAAO,IAAIC,kBAGf,OAAQ,kBAAC,iBAAD,CAAgB3T,OAAQA,GAC5B,6BACI,kBAAC,GAAD,CAAUA,OAAQA,O,2gCCvC9B,IAAM4T,GAAcC,aAAe,CAClCC,UAAW,CACVC,aAAc,CAAEC,KAAM,CAAEnS,MAAO,QAASkL,YAAa,UACrDkH,iBAAkB,CACjBD,KAAM,CACL,oBAAqB,CACpBjH,YAAa,6BAEd,mEAAoE,CACnEA,YAAa,UACb,uBAAwB,CACvBA,YAAa,8BAGf,4BAA6B,CAC5BA,YAAa,UACbmH,YAAa,KAIhBC,SAAU,CACTzC,MAAO,CACN,iBAAkB,CACjB7P,MAAO,QAERA,MAAO,aAOLuS,GAAc1U,cAAH,MASX2U,GAAe3U,cAAH,MAQZ4U,GAAW5U,cAAH,MAURiM,GAAcjM,cAAH,MAyPF6U,OAhPf,WAAqB,IAAD,EACEpI,sBAAYR,IAA1BS,EADY,sBAEED,sBAAYiI,GAAa,CAC7C9H,YAD6C,YAChB,IAAfkI,EAAc,EAAdA,WACPvU,EAAWuU,EAAWvU,SACtBX,EAAYkV,EAAWlV,UAC7BmV,EAAY,CAAEtU,UAAW,CAAEF,WAAUX,kBAJhCkV,EAFY,sBASGrI,sBAAYkI,GAAc,CAC/C/H,YAD+C,YACjB,IAAhBmI,EAAe,EAAfA,YACP3J,EAAmB,UAAR4J,EAAkBC,EAAgBC,EACnDtW,aAAa0C,QAAQ,QAASyT,EAAYrC,OAC1C9T,aAAa0C,QAAQ,WAAYyT,EAAYxU,UAC7C3B,aAAa0C,QAAQ,WAAY6J,GAAqBC,IACtDsB,EAAW,CAAEjM,UAAW,CAAEF,SAAUwU,EAAYxU,SAAUwM,KAAMxB,QAChEnG,OAAO4L,SAASC,KAAO7L,OAAO4L,SAASC,KAAO,UAPzC8D,EATY,sBAoBQtI,sBAAYkI,GAAc,CACpD/H,YADoD,YACtB,IAAhBmI,EAAe,EAAfA,YACbnW,aAAa0C,QAAQ,QAASyT,EAAYrC,OAC1CtN,OAAO4L,SAASC,KAAO7L,OAAO4L,SAASC,KAAO,UAHzCkE,EApBY,sBA2B6B3M,mBAAS,IA3BtC,mBA2BZ4M,EA3BY,KA2BMC,EA3BN,OA4B6B7M,mBAAS,IA5BtC,mBA4BZ0M,EA5BY,KA4BMI,EA5BN,OA8BuB9M,mBAAS,IA9BhC,mBA8BZ+M,EA9BY,KA8BGC,EA9BH,OA+BuBhN,mBAAS,IA/BhC,mBA+BZyM,EA/BY,KA+BGQ,EA/BH,OAiCuCjN,oBAAS,GAjChD,mBAiCZkN,EAjCY,KAiCWC,EAjCX,OAkCiBnN,oBAAS,GAlC1B,mBAkCZoN,EAlCY,KAkCAC,EAlCA,OAoCuBrN,oBAAS,GApChC,mBAoCZsN,EApCY,KAoCGC,EApCH,OAsCGvN,mBAAS,SAtCZ,mBAsCZwM,EAtCY,KAsCPgB,EAtCO,OAwCQxV,mBAASoU,GAAU,CAC7CnU,UAAW,CAAEF,SAAkB,UAARyU,EAAkBO,EAAgBH,KADlDxU,EAxCW,EAwCXA,MAAOE,EAxCI,EAwCJA,QAITmV,EAAO,uCAAG,WAAOC,GAAP,eAAAjM,EAAA,sDACT1J,EAAmB,UAARyU,EAAkBO,EAAgBH,EACnD1G,QAAQC,QAAQhE,GAAauL,EAAiB,OAAOlL,MAAK,SAAU4D,GACnE,IAAMhP,EAAYgP,EAAMhP,UAClB4B,EAAaoN,EAAMpN,WACzBsT,EAAW,CAAErU,UAAW,CAAEF,WAAUX,eACpChB,aAAa0C,QAAQ,iBAAkB1B,GACvChB,aAAa0C,QAAQ,kBAAmBE,GACxC5C,aAAa0C,QAAQ,WAAYf,MARnB,2CAAH,sDAYP4V,EAAY,uCAAG,8BAAAlM,EAAA,sEACanJ,EAAQ,CAAEP,SAAU6U,IADjC,gBACNgB,EADM,EACZvV,KACJD,EACHqV,EAAQb,GAGa,MAAjBgB,EAAS5W,MACZmW,GAAyB,GACzBM,EAAQb,KAGRO,GAAyB,GACzBI,GAAiB,IAZC,2CAAH,qDAiBZM,EAAS,uCAAG,oCAAApM,EAAA,sEACgBnJ,EAAQ,CAAEP,SAAUgV,IADpC,gBACHa,EADG,EACTvV,KACJD,GACHkL,QAAQlL,MAAMA,GACdiV,GAAc,GACdE,GAAiB,IAGK,OAAlBK,EAAS5W,MACZqW,GAAc,GACdE,GAAiB,KAGXtK,EAAiBN,GAAqB8J,GAC5BvJ,GAAgB0K,EAAS5W,KAAKuN,KAAMtB,IAE7ClL,EAAW3B,aAAaC,QAAQ,YAChCe,EAAYhB,aAAaC,QAAQ,kBACvCsW,EAAiB,CAAE1U,UAAW,CAAEF,WAAUX,iBAG1CiW,GAAc,GACdE,GAAiB,KAtBH,2CAAH,qDA4Bf,OACC,kBAACO,GAAA,EAAD,CAAe/F,MAAO2D,IACrB,kBAACqC,GAAA,EAAD,CAAMC,MAAM,EACXjV,GAAG,yBACH8B,UAAU,cACVoT,UAAWzB,EACX0B,SAAU,SAACC,GAAD,OAAOX,EAAOW,KAExB,kBAACC,GAAA,EAAD,CAAKC,SAAS,QAAQ9T,MAAM,SAC3B,yBAAKM,UAAU,YACd,kBAACyT,GAAA,EAAD,CACCC,WAAY,CACXvT,MAAO,CAAErB,MAAO,UAEjBZ,GAAG,iBAAiByV,MAAM,WAC1B5I,QAAQ,WACRvC,MAAO0J,EACPpT,MAAO,YACP8U,WAAW,EACXzJ,SAAU,SAACrJ,GAAD,OAAOqR,EAAiBrR,EAAEN,OAAOgI,UAE5C,6BACA,6BACA,kBAACiL,GAAA,EAAD,CACCC,WAAY,CACXvT,MAAO,CAAErB,MAAO,UAEjBZ,GAAG,iBAAiByV,MAAM,WAC1B5I,QAAQ,WACRvC,MAAOoJ,EACP5W,KAAK,WACL8D,MAAO,YACP8U,WAAW,EACXzJ,SAAU,SAACrJ,GAAD,OAAOsR,EAAiBtR,EAAEN,OAAOgI,UAE5C,6BACA,6BACA,kBAAC,KAAD,CAAQqL,SAAUpB,EAAexS,QAAS,SAACa,GAC1CA,EAAE+N,iBACF6D,GAAiB,GACjBM,KACEjI,QAAQ,YAAYjM,MAAM,aAC3B2T,GAAiB,kBAACqB,GAAA,EAAD,CACjB9N,KAAM,GACN7F,MAAO,CAAErB,MAAO,QAAS0E,YAAa,UAPxC,UAUA,6BACA,6BACA,kBAACuQ,GAAA,EAAD,CAAUC,GAAIzB,GACb,kBAAC0B,GAAA,EAAD,CACCC,OACC,kBAACC,GAAA,EAAD,CACCC,aAAW,QACXtV,MAAM,UACNkH,KAAK,QACL/F,QAAS,WACRuS,GAAc,KAGf,kBAAC,KAAD,CAAWhF,SAAS,aAGtBzC,QAAQ,SAASsJ,SAAS,SAb3B,oBAqBH,kBAACd,GAAA,EAAD,CAAKC,SAAS,WAAW9T,MAAM,YAC9B,yBAAKM,UAAU,YACd,kBAACyT,GAAA,EAAD,CACCC,WAAY,CACXvT,MAAO,CAAErB,MAAO,UAEjBZ,GAAG,iBAAiByV,MAAM,WAC1B5I,QAAQ,WACRvC,MAAOuJ,EACPjT,MAAO,YACP8U,WAAW,EACXzJ,SAAU,SAACrJ,GAAD,OAAOkR,EAAoBlR,EAAEN,OAAOgI,UAE/C,6BACA,6BACA,kBAACiL,GAAA,EAAD,CACCC,WAAY,CACXvT,MAAO,CAAErB,MAAO,UAEjBZ,GAAG,iBAAiByV,MAAM,WAC1B5I,QAAQ,WACRvC,MAAOqJ,EACP7W,KAAK,WACL8D,MAAO,YACP8U,WAAW,EACXzJ,SAAU,SAACrJ,GAAD,OAAOmR,EAAoBnR,EAAEN,OAAOgI,UAE/C,6BACA,6BACA,kBAAC,KAAD,CAAQqL,SAAUpB,EAAexS,QAAS,SAACa,GAC1CA,EAAE+N,iBACF6D,GAAiB,GACjBI,KACE/H,QAAQ,YAAYjM,MAAM,aAC3B2T,GAAiB,kBAACqB,GAAA,EAAD,CACjB9N,KAAM,GACN7F,MAAO,CAAErB,MAAO,QAAS0E,YAAa,UAPxC,aAUA,6BACA,6BACA,kBAACuQ,GAAA,EAAD,CAAUC,GAAI3B,GACb,kBAAC4B,GAAA,EAAD,CACCC,OACC,kBAACC,GAAA,EAAD,CACCC,aAAW,QACXtV,MAAM,UACNkH,KAAK,QACL/F,QAAS,WACRqS,GAAyB,KAG1B,kBAAC,KAAD,CAAW9E,SAAS,aAGtBzC,QAAQ,SAASsJ,SAAS,SAb3B,qDC5OQC,OAtDf,WACI,IAAMpF,EAAanN,OAAO4L,SAASC,KAAK5M,SAAS,sBAC3CmO,EAAYD,EAAa,gCAAkC,wBAC3DE,EAAQF,EAAa,8BAAgC,sBACrDG,EAAQ9T,aAAaC,QAAQ,SAC7B8T,EAAWC,yBAAe,CAC5BvM,IAAI,GAAD,OAAKmM,EAAL,cAGDK,EAAWC,cAAW,SAACC,EAAD,GAAqB,IAAfC,EAAc,EAAdA,QAC9B,MAAO,CACHA,QAAQ,2BACDA,GADA,IAEHC,cAAeP,EAAK,UAAMA,GAAU,SAK1CQ,EAAS,IAAIC,KAAc,CAC7B9M,IAAI,GAAD,OAAKoM,EAAL,YACHW,QAAS,CACLC,WAAW,EACXC,iBAAkB,CACdC,cAAeb,MAKrBc,EAAYlM,iBACd,YAAgB,IAAbmM,EAAY,EAAZA,MACOC,EAAaC,aAAkBF,GACrC,MACwB,wBAApBC,EAAWE,MACc,iBAAzBF,EAAWG,YAGnBX,EACAL,EAAS9J,OAAO4J,IAGdrS,EAAS,IAAIwT,eAAa,CAC5BC,KAAMP,EACNQ,MAAO,IAAIC,kBAGf,OAAQ,kBAAC,iBAAD,CAAgB3T,OAAQA,GAC5B,yBAAK+C,UAAU,OACX,4BAAQA,UAAU,cACd,kBAAC,GAAD,UC/BDuU,OAhBf,WACE,OACE,kBAAC,IAAD,CAAYC,SAAS,KACnB,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAOC,KAAK,SACV,kBAAC,GAAD,OAEF,kBAAC,IAAD,CAAOA,KAAK,KACV,kBAAC,GAAD,UCNUnR,QACW,cAA7BvB,OAAO4L,SAAS+G,UAEe,UAA7B3S,OAAO4L,SAAS+G,UAEhB3S,OAAO4L,SAAS+G,SAASvQ,MACvB,2DCZNwQ,IAASC,OACP,kBAAC,IAAMC,SAAP,KACE,kBAAC,GAAD,OAEFjX,SAASkX,eAAe,SDiIpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrBtN,MAAK,SAAAuN,GACJA,EAAaC,gBAEdC,OAAM,SAAA7X,GACLkL,QAAQlL,MAAMA,EAAMxC,a","file":"static/js/main.f384bd50.chunk.js","sourcesContent":["import JSEncrypt from 'jsencrypt';\nimport CryptoJS from \"crypto-js\";\n\nexport function encryptMessage(message, type, groupId){\n    var messageJSON = {\"message\": message, \"type\":type}\n    var messageString = JSON.stringify(messageJSON);\n    const groupPrivateKey = localStorage.getItem(`${groupId}-privateKey`);\n    const encrypted = CryptoJS.AES.encrypt(messageString, groupPrivateKey).toString();\n    return encrypted;\n}\n\nexport function decryptMessage(message, groupId){\n    const groupPrivateKey = localStorage.getItem(`${groupId}-privateKey`);\n    const decrypt = CryptoJS.AES.decrypt(message, groupPrivateKey);\n    return JSON.parse(decrypt.toString(CryptoJS.enc.Utf8));\n}\n\nexport function encryptMessageForPrivateKey(message, user){\n    var crypt = new JSEncrypt();\n    crypt.setPublicKey(user.publicKey);\n    const encrypted = crypt.encrypt(message);\n    return encrypted;\n}\n\nexport function decryptMessageForPrivateKey(message){\n    var crypt = new JSEncrypt();\n    crypt.setPrivateKey(localStorage.getItem('user-privateKey'));\n    const decrypted = crypt.decrypt(message);\n    return decrypted;\n}\n","import React, { useEffect } from 'react';\n\nimport {\n  gql,\n  useQuery\n} from '@apollo/client';\n\nimport { ChatList } from 'react-chat-elements'\nimport 'react-chat-elements/dist/main.css';\nimport './../App.css';\nimport 'react-chat-elements/dist/main.css';\n\nimport { decryptMessageForPrivateKey } from '../utils/AESEncryption';\n\nconst GET_GROUPS = gql`\n  query getGroupsWithUser($username: String!) {\n    groupsByUser(username: $username){\n      id\n      name\n      users {\n        username\n      }\n      privateKey\n    }\n  }\n`;\n\nconst GROUP_SUBSCRIPTION = gql`\n    subscription getNewGroups($username: String!){\n        newGroup(username: $username){\n          id\n          users{\n            username\n          }\n          name\n          publicKey\n          privateKey\n        }\n    }\n`;\n\nfunction ChatLeftList({ selectedGroup, setSelectedGroup, setDoneFetching, client }) {\n  const username = localStorage.getItem('username');\n\n  const {\n    subscribeToMore,\n    loading,\n    error,\n    data,\n    refetch\n  } = useQuery(GET_GROUPS, {\n    variables: {\n      username\n    }\n  });\n\n  useEffect(() => {\n    const subscribe = subscribeToMore({\n      document: GROUP_SUBSCRIPTION,\n      variables: { username },\n      updateQuery: (prev, { subscriptionData }) => {\n        if (!subscriptionData.data) return prev;\n        const newGroup = subscriptionData.data.newGroup;\n        localStorage.setItem(`${newGroup.id}-privateKey`, decryptMessageForPrivateKey(newGroup.privateKey));\n        return Object.assign({}, prev, {\n          groupsByUser: [newGroup, ...prev.groupsByUser]\n        });\n      }\n    });\n    return function cleanup() {\n      subscribe();\n    };\n  }, [subscribeToMore, username]);\n\n\n  if (loading) return 'Loading...';\n  if (error) {\n    client.resetStore();\n    refetch();\n    return `Error! ${error.message}`;\n  }\n\n  const stringToColor = (groupName) => {\n    var hash = 0;\n    for (var i = 0; i < groupName.length; i++) {\n      hash = groupName.charCodeAt(i) + ((hash << 5) - hash);\n    }\n    var color = '#';\n    for (var i = 0; i < 3; i++) {\n      var value = (hash >> (i * 8)) & 0xFF;\n      color += ('00' + value.toString(16)).substr(-2);\n    }\n    return color;\n  }\n\n  const dataSource = data.groupsByUser.map(group => {\n    if (localStorage.getItem(`${group.id}-privateKey`) == null || localStorage.getItem(`${group.id}-privateKey`) === 'undefined') {\n      localStorage.setItem(`${group.id}-privateKey`, decryptMessageForPrivateKey(group.privateKey));\n    }\n    const users = group.users.map(user => `@${user.username}`);\n    return {\n      letterItem: { letter: group.name.charAt(0).toUpperCase(), id: stringToColor(group.name) },\n      alt: group.name,\n      title: group.name,\n      subtitle: users.join(\", \"),\n      date: new Date(),\n      unread: 0,\n      id: group.id,\n      className: selectedGroup === group.id ? \"activeChatLeft\" : \"notActiveChatLeft\"\n    }\n  });\n\n\n  return (<ChatList onClick={(chat) => { setSelectedGroup(chat.id); setDoneFetching(false);}}\n    style={{\n      backgroundColor: \"#121212\"\n    }}\n    dataSource={dataSource} />)\n}\n\nexport default ChatLeftList;","// convert file to base64\n// base64 to encrypted\n// return base64\n\n/**\n * {\n *  content: xyz,\n *  filename: app.pdf\n * }\n * \n */\n\n// https://github.com/Detaysoft/react-chat-elements\n// https://stackoverflow.com/questions/46119987/upload-and-read-a-file-in-react\n\nimport CryptoJS from \"crypto-js\";\nimport { saveAs } from 'file-saver';\n\nexport const convertFileToBase64 = (event, groupId, createMessage, username) => {\n    if (event.target.files == null){\n        return;\n    }\n    const reader = new FileReader();\n    reader.readAsDataURL(event.target.files[0]); \n    reader.onload = function(e) {\n        const cType =  (event.target.files[0].type.includes(\"image/\")) ? 'photo' : 'file';\n        var rawLog = reader.result;\n        const message = encryptFile(rawLog, event.target.files[0].name, groupId);   \n        createMessage({ variables: { username, gid: groupId, content: message, cType } }); \n    };\n}\n\nexport function encryptFile(message, filename, groupId){\n    var messageJSON = {\"content\": message, \"filename\": filename};\n    var messageString = JSON.stringify(messageJSON);\n    const groupPrivateKey = localStorage.getItem(`${groupId}-privateKey`);\n    const encrypted = CryptoJS.AES.encrypt(messageString, groupPrivateKey).toString();\n    return encrypted;\n}\n\nexport function dataURLtoFile(dataurl, filename) {\n    var arr = dataurl.split(','),\n        mime = arr[0].match(/:(.*?);/)[1],\n        bstr = atob(arr[1]), \n        n = bstr.length, \n        u8arr = new Uint8Array(n);\n    while(n--){\n        u8arr[n] = bstr.charCodeAt(n);\n    }\n    const file = new File([u8arr], filename, {type:mime});\n    saveAs(file, filename);\n}\n","import React, { useEffect } from 'react';\nimport { ChatFeed as ChatFeedUI } from 'react-chat-ui';\nimport ClipLoader from \"react-spinners/ClipLoader\";\nimport { css } from \"@emotion/core\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport 'react-chat-elements/dist/main.css';\nimport { MessageList } from 'react-chat-elements'\nimport 'react-chat-elements/dist/main.css';\nimport {dataURLtoFile} from './../utils/files';\n\nconst override = css`\n  display: block;\n  margin: 0 auto;\n  border-color: red;\n`;\n\nfunction ChatFeed({\n    messages,\n    onLoadMore,\n    doneFetching,\n    selectedGroup,\n}) {\n    let messagesEndRef = React.createRef();\n    let messagesStartRef = React.createRef();\n\n    window.lm = onLoadMore;\n\n    useEffect(() => {\n        messagesEndRef.scrollIntoView({ behavior: \"smooth\" });\n        const interval = setInterval(() => {\n            const offset = 0;\n            if (!messagesStartRef) return false;\n            const top = messagesStartRef.getBoundingClientRect().top;\n            const inView = (top + offset) >= 0 && (top - offset) <= window.innerHeight;\n            if (inView) {\n                // onLoadMore();\n            }\n        }, 1000);\n        return function cleanup() {\n            clearInterval(interval);\n        }\n    }, [onLoadMore, messagesStartRef, messagesEndRef]);\n\n    const height = window.innerHeight * 0.86;\n    const username = localStorage.getItem('username');\n    const dataSource = messages.map(messagebox => {\n        if (messagebox.cType === \"text\") {\n            return {\n                position: messagebox.sender === username ? 'right' : 'left',\n                type: 'text',\n                text: messagebox.message.message,\n                title: messagebox.senderName,\n                date: new Date(parseInt(messagebox.ts)),\n            };\n        }\n        if (messagebox.cType === \"photo\") {\n            return {\n                position: messagebox.sender === username ? 'right' : 'left',\n                type: 'photo',\n                title: messagebox.senderName,\n                date: new Date(parseInt(messagebox.ts)),\n                data: {\n                    uri: messagebox.message.content,\n                    filename: messagebox.message.filename,\n                    status: {\n                        click: false,\n                        loading: 0,\n                    },\n                    width: \"300px\",\n                    height: \"150px\"\n                }\n            };\n        }\n        if (messagebox.cType === \"file\") {\n            return {\n                position: messagebox.sender === username ? 'right' : 'left',\n                type: 'file',\n                text: messagebox.message.filename,\n                title: messagebox.senderName,\n                date: new Date(parseInt(messagebox.ts)),\n                data: {\n                    uri: messagebox.message.content,\n                    status: {\n                        click: false,\n                        loading: 0,\n                    }\n                }\n            };\n        }\n        return null;\n    }).filter(Boolean);\n\n    return <div style={{ marginLeft: 5, marginRight: 5, marginBottom: 50 }}>\n\n        <div style={{ height: 30 }}\n            ref={(el) => { messagesStartRef = el; }}>\n            {\n                // doneFetching ? <div /> : <ClipLoader\n                //     css={override}\n                //     size={30}\n                //     color={\"#123abc\"}\n                //     loading={true}\n                // />\n            }\n        </div>\n        <div style={{ }}>\n            <MessageList\n                className='message-list'\n                lockable={true}\n                toBottomHeight={'86%'}\n                onDownload={(e) => {\n                    dataURLtoFile(e.data.uri, e.type === 'photo' ? e.data.filename : e.text)\n                }}\n                dataSource={dataSource}\n            />\n        </div>\n        <div style={{ float: \"left\", clear: \"both\" }}\n            ref={(el) => { messagesEndRef = el; }}>\n        </div>\n    </div>;\n}\n\nexport default ChatFeed;","import React, { useEffect, useState } from 'react';\n\nimport {\n    gql,\n    useQuery\n} from '@apollo/client';\nimport { css } from \"@emotion/core\";\nimport ClipLoader from \"react-spinners/ClipLoader\";\nimport ChatFeed from './ChatFeed.react';\nimport { decryptMessage } from '../utils/AESEncryption';\nimport 'react-chat-elements/dist/main.css';\n\nconst GET_MESSAGES = gql`\n    query getMessagesForGroup($gid: Int!, $offset: Int, $limit: Int) {\n        messagesByGroup(gid: $gid, count: $limit, offset: $offset){\n            id\n            content\n            ts\n            sender\n            group\n            cType\n        }\n    }\n`;\n\nconst MESSAGE_SUBSCRIPTION = gql`\n    subscription getNewMessages($gid: Int!){\n        newMessage(gid: $gid){\n            id\n            content\n            ts\n            sender\n            group\n            cType\n        }\n    }\n`;\n\nconst override = css`\n  display: block;\n  margin: 0 auto;\n  border-color: red;\n`;\n\nfunction ChatMessages({\n    selectedGroup, doneFetching, setDoneFetching\n}) {\n    const [messages, setMessages] = useState([]);\n    const { subscribeToMore, loading, error, data, fetchMore } = useQuery(\n        GET_MESSAGES,\n        {\n            variables: {\n                gid: selectedGroup,\n                offset: 0,\n                limit: 50\n            },\n            fetchPolicy: \"network\"\n        }\n    );\n\n    useEffect(() => {\n        const username = localStorage.getItem('username');\n        if (data) {\n            const reversedEntries = [].concat(data.messagesByGroup).reverse();\n            const messageObjects = reversedEntries.map(message => {\n                if (localStorage.getItem(`${selectedGroup}-privateKey`) == null || localStorage.getItem(`${selectedGroup}-privateKey`) === 'undefined') {\n                    return null;\n                }\n                return { sender: message.sender, message: decryptMessage(message.content, selectedGroup), senderName: `@${message.sender}`, cType: message.cType, ts: message.ts };\n            }).filter(Boolean);\n            setMessages(messageObjects);\n        }\n        const subscription = subscribeToMore({\n            document: MESSAGE_SUBSCRIPTION,\n            variables: { gid: selectedGroup },\n            updateQuery: (prev, { subscriptionData }) => {\n                if (!subscriptionData.data) {\n                    setDoneFetching(true);\n                    return prev;\n                }\n                const newFeedItem = subscriptionData.data.newMessage;\n                const newMessage = { sender: newFeedItem.sender, message: decryptMessage(newFeedItem.content, selectedGroup), senderName: `@${newFeedItem.sender}`, cType: newFeedItem.cType, ts: newFeedItem.ts };\n                setMessages(messages => [...messages, newMessage]);\n                return Object.assign({}, prev, {\n                    messagesByGroup: [newFeedItem, ...prev.messagesByGroup]\n                });\n            }\n        });\n        return function cleanup() {\n            subscription();\n        };\n    }, [subscribeToMore, selectedGroup, data]);\n\n    if (loading) return (<div style={{ marginLeft: '10px', marginRight: '10px', marginBottom: '50px' }}>\n        <div style={{ height: '30px' }}>\n            {\n                !doneFetching && <ClipLoader\n                    css={override}\n                    size={30}\n                    color={\"#123abc\"}\n                    loading={true}\n                />\n            }\n        </div>\n    </div>);\n    if (error) return `Error! ${error.message}`;\n    return <ChatFeed messages={messages} selectedGroup={selectedGroup} doneFetching={doneFetching} onLoadMore={() => {\n        if (doneFetching) {\n            return;\n        }\n        return fetchMore({\n            variables: {\n                offset: data.messagesByGroup.length\n            },\n            updateQuery: (prev, { fetchMoreResult }) => {\n                if (fetchMoreResult.messagesByGroup.length === 0) {\n                    setDoneFetching(true);\n                }\n                const futureMessages = fetchMoreResult.messagesByGroup;\n                const username = localStorage.getItem('username');\n                const messageObjects = futureMessages.map(message => {\n                    if (localStorage.getItem(`${selectedGroup}-privateKey`) == null || localStorage.getItem(`${selectedGroup}-privateKey`) === 'undefined') {\n                        return null;\n                    }\n                    return { sender: message.sender, message: decryptMessage(message.content, selectedGroup), senderName: `@${message.sender}`, cType: message.cType, ts: message.ts };\n                }).filter(Boolean);\n                setMessages(messages => [...messages, ...messageObjects]);\n                return Object.assign({}, prev, {\n                    messagesByGroup: [...prev.messagesByGroup, ...fetchMoreResult.messagesByGroup],\n                });\n            }\n        })\n    }}>\n    </ChatFeed>;\n}\n\nexport default ChatMessages;","import '../App.css';\nimport pbkdf2 from 'pbkdf2';\n\nfunction ab2str(buf: any) {\n    return String.fromCharCode.apply(null, Array.from(new Uint8Array(buf)));\n}\n\nasync function exportCryptoPublicKey(key: any) {\n    const exported = await window.crypto.subtle.exportKey(\n        \"spki\",\n        key\n    );\n    const exportedAsString = ab2str(exported);\n    const exportedAsBase64 = window.btoa(exportedAsString);\n    const pemExported = `-----BEGIN PUBLIC KEY-----\\n${exportedAsBase64}\\n-----END PUBLIC KEY-----`;\n    return pemExported;\n}\n\nasync function exportCryptoPrivateKey(key: any) {\n    const exported = await window.crypto.subtle.exportKey(\n        \"pkcs8\",\n        key\n    );\n    const exportedAsString = ab2str(exported);\n    const exportedAsBase64 = window.btoa(exportedAsString);\n    const pemExported = `-----BEGIN PRIVATE KEY-----\\n${exportedAsBase64}\\n-----END PRIVATE KEY-----`;\n    return pemExported;\n}\n\n\nexport async function generateKeys(username: string, modulus: number) {\n    const response = await window.crypto.subtle.generateKey({\n        name: \"RSA-OAEP\",\n        modulusLength: modulus,\n        publicExponent: new Uint8Array([1, 0, 1]),\n        hash: \"SHA-256\",\n    },\n        true,\n        [\"encrypt\", \"decrypt\"]\n    ).then(async (keyPair) => {\n        const publicKey = await exportCryptoPublicKey(keyPair.publicKey);\n        const privateKey = await exportCryptoPrivateKey(keyPair.privateKey);\n        return {\n            privateKey,\n            username,\n            publicKey\n        }\n    });\n    return response;\n}\n\n\nexport function generatePasswordHash(password: string){\n    var derivedKey = pbkdf2.pbkdf2Sync(password, 'salt', 1, 32, 'sha512').toString('hex');\n    return derivedKey;\n}","import CryptoJS from \"crypto-js\";\n\nexport function encryptLocalStorage() {\n    const localStorageString = JSON.stringify(localStorage);\n    const hashedPassword: string = localStorage.getItem('password') || '';\n    const encrypted = CryptoJS.AES.encrypt(localStorageString, hashedPassword).toString();\n    return encrypted;\n}\n\nexport function setLocalStorage(localStorageString: string, hashedPassword: string) {\n    const decrypt = CryptoJS.AES.decrypt(localStorageString, hashedPassword);\n    try{\n        const localStorageDict = JSON.parse(decrypt.toString(CryptoJS.enc.Utf8));\n        for (const [key, value] of Object.entries(localStorageDict)) {\n            localStorage.setItem(key, (value as string));\n        }\n    }\n    catch(e){\n        console.error(e);\n        return false;\n    }\n    return true;\n}","import React, { useState } from 'react';\nimport TagsInput from 'react-tagsinput'\nimport 'react-tagsinput/react-tagsinput.css'\nimport { gql, useMutation } from '@apollo/client';\nimport { generateKeys } from '../utils/generateKeys'\nimport { encryptMessageForPrivateKey } from '../utils/AESEncryption';\nimport {encryptLocalStorage} from '../utils/localStorageKeyGen';\n\nimport Modal from 'react-bootstrap/Modal';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nconst CREATE_GROUP = gql`\nmutation createGroup($name: String!, $publicKey: String!, $users: [String!]){\n    createGroup(name:$name, publicKey:$publicKey, users:$users){\n      id\n      name\n      publicKey\n      users{\n          username\n          publicKey\n      }\n    }\n  }\n`;\n\nconst SEND_MESSAGE = gql`\n    mutation createPrivateKey($username: String!, $privateKey: String!, $gid: Int!){\n        createPrivateKey(username:$username, gid:$gid, privateKey:$privateKey){\n            id\n            privateKey\n        }\n    }\n`;\n\nconst UPDATE_KEYS = gql`\n    mutation updateKeys($username: String!, $keys: String!){\n        updateKeys(username:$username, keys:$keys){\n            success\n        }\n    }\n`;\n\nfunction GroupChatTags({ show, setShow }) {\n    const [tags, setTags] = useState([]);\n\n    const handleClose = () => setShow(false);\n    const [groupName, setgroupName] = useState(\"\");\n    const [updateKeys] = useMutation(UPDATE_KEYS);\n    const [createPrivateKey] = useMutation(SEND_MESSAGE);\n    const [createGroup] = useMutation(CREATE_GROUP, {\n        onCompleted({ createGroup }) {\n            const username = localStorage.getItem('username');\n            const privateKey = localStorage.getItem('temp-group-privatekey')\n            localStorage.setItem(`${createGroup.id}-privateKey`, privateKey);\n            localStorage.removeItem('temp-group-privatekey');\n            createGroup.users.map(user => {\n                const content = encryptMessageForPrivateKey(privateKey, user);\n                createPrivateKey({ variables: { username: user.username, gid: createGroup.id, privateKey: content} });\n                return true;\n            });\n            updateKeys({variables: {username, keys: encryptLocalStorage()}});\n            handleClose();\n        }\n    });\n\n    const createGroupChat = (raw_tags, groupName) => {\n        raw_tags.push(localStorage.getItem('username')) // transparently include current user in every group they create\n        function onlyUnique(value, index, self) {\n            return self.indexOf(value) === index;\n        }\n        var tags = raw_tags.filter(onlyUnique);\n        if (tags && tags.length > 0) {\n            Promise.resolve(generateKeys(groupName, 256)).then(function (array) {\n                const publicKey = array.publicKey\n                const privateKey = array.privateKey\n                localStorage.setItem('temp-group-privatekey', privateKey);\n                createGroup({ variables: { users: tags, publicKey: publicKey, name: groupName } });\n            });\n        }\n    }\n\n    return (\n        <div style={{backgroundColor: \"#2e2e2e\"}}>\n            <Modal show={show} transparent={\"true\"} onHide={handleClose}>\n                <Modal.Header closeButton style={{backgroundColor: \"#2e2e2e\", borderColor: \"#2e2e2e\"}}>\n                    <Modal.Title>Input the individuals to add to your new Group Chat!</Modal.Title>\n                </Modal.Header>\n\n                <Modal.Body style={{backgroundColor: \"#2e2e2e\", borderColor: \"#2e2e2e\"}}>\n                    <TagsInput style={{color: \"white\"}} value={tags} onChange={(newTags) => setTags(newTags)} inputProps={{\n                        className: 'react-tagsinput-input',\n                        placeholder: 'Add people!'\n                    }} onlyUnique />\n                    <Form style={{marginTop: \"20px\"}}>\n                        <Form.Group>\n                            <Form.Control testid={\"createGroupInputField\"} style={{color: \"black\"}} type=\"text\" placeholder=\"Group Name\" value={groupName} onChange={(e) => setgroupName(e.target.value)} />\n                        </Form.Group>\n                    </Form>\n                </Modal.Body>\n                <Modal.Footer style={{backgroundColor: \"#2e2e2e\", borderColor: \"#2e2e2e\"}}>\n                    <Button variant=\"secondary\" onClick={handleClose}>\n                        Close\n                    </Button>\n                        <Button variant=\"primary\" onClick={() => createGroupChat(tags, groupName)}>\n                            Create Group!\n                    </Button>\n                </Modal.Footer>\n            </Modal>\n        </div>);\n}\nexport default GroupChatTags;\n","import React, { useState } from 'react';\nimport TagsInput from 'react-tagsinput'\nimport 'react-tagsinput/react-tagsinput.css'\nimport { gql, useMutation } from '@apollo/client';\nimport { generateKeys } from '../utils/generateKeys'\nimport { encryptMessageForPrivateKey } from '../utils/AESEncryption';\nimport {encryptLocalStorage} from '../utils/localStorageKeyGen';\n\nimport Modal from 'react-bootstrap/Modal';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nconst ADD_MEMBER_GROUP = gql`\nmutation addMemberToGroup($gid: Int!, $users: [String!]){\n    addGroupMember(gid:$gid, users:$users){\n      id\n      name\n      publicKey\n      users{\n          username\n          publicKey\n      }\n    }\n  }\n`;\n\nconst SEND_MESSAGE = gql`\n    mutation createPrivateKey($username: String!, $privateKey: String!, $gid: Int!){\n        createPrivateKey(username:$username, gid:$gid, privateKey:$privateKey){\n            id\n            privateKey\n        }\n    }\n`;\n\nconst UPDATE_KEYS = gql`\n    mutation updateKeys($username: String!, $keys: String!){\n        updateKeys(username:$username, keys:$keys){\n            success\n        }\n    }\n`;\n\nfunction AddGroupMember({ show, setShow, groupId }) {\n    const [tags, setTags] = useState([]);\n\n    const handleClose = () => setShow(false);\n    const [groupName, setgroupName] = useState(\"\");\n    const [updateKeys] = useMutation(UPDATE_KEYS);\n    const [createPrivateKey] = useMutation(SEND_MESSAGE);\n    const [addToGroup] = useMutation(ADD_MEMBER_GROUP, {\n        onCompleted({addGroupMember}) {\n            const username = localStorage.getItem('username');\n            const privateKey = localStorage.getItem(`${addGroupMember.id}-privateKey`);\n            addGroupMember.users.map(user => {\n                const content = encryptMessageForPrivateKey(privateKey, user);\n                createPrivateKey({ variables: { username: user.username, gid: addGroupMember.id, privateKey: content} });\n                return true;\n            });\n            updateKeys({variables: {username, keys: encryptLocalStorage()}});\n            handleClose();\n        }\n    });\n\n    const addMemberToGroup = (raw_tags) => {\n        function onlyUnique(value, index, self) {\n            return self.indexOf(value) === index;\n        }\n        var tags = raw_tags.filter(onlyUnique);\n        if (tags && tags.length > 0) {\n            addToGroup({ variables: { users: tags, gid: parseInt(groupId) } });\n        }\n    }\n\n    return (\n        <div style={{backgroundColor: \"#2e2e2e\"}}>\n            <Modal show={show} transparent={\"true\"} onHide={handleClose}>\n                <Modal.Header closeButton style={{backgroundColor: \"#2e2e2e\", borderColor: \"#2e2e2e\"}}>\n                    <Modal.Title>Input the individuals to add to your this group!</Modal.Title>\n                </Modal.Header>\n\n                <Modal.Body style={{backgroundColor: \"#2e2e2e\", borderColor: \"#2e2e2e\"}}>\n                    <TagsInput style={{color: \"white\"}} value={tags} onChange={(newTags) => setTags(newTags)} inputProps={{\n                        className: 'react-tagsinput-input',\n                        placeholder: 'Add people!'\n                    }} onlyUnique />\n                </Modal.Body>\n                <Modal.Footer style={{backgroundColor: \"#2e2e2e\", borderColor: \"#2e2e2e\"}}>\n                    <Button variant=\"secondary\" onClick={handleClose}>\n                        Close\n                    </Button>\n                        <Button variant=\"primary\" onClick={() => addMemberToGroup(tags)}>\n                            Add Members!\n                    </Button>\n                </Modal.Footer>\n            </Modal>\n        </div>);\n}\nexport default AddGroupMember;\n","import React, { useState, useRef } from 'react';\nimport ChatLeftList from './ChatLeftList.react';\nimport ChatMessages from './ChatMessages.react';\nimport Button from 'react-bootstrap/Button';\nimport './../App.css';\nimport {\n    gql,\n    useMutation\n} from '@apollo/client';\nimport Avatar from 'react-avatar';\nimport { Input, Button as ChatButton } from 'react-chat-elements'\nimport { ThemeProvider, darkTheme, elegantTheme, purpleTheme, defaultTheme } from '@livechat/ui-kit'\nimport GroupChatTags from './GroupChatTags.react';\nimport { encryptMessage } from '../utils/AESEncryption';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport 'react-chat-elements/dist/main.css';\nimport {convertFileToBase64} from './../utils/files';\nimport AddGroupMember from './AddGroupMember.react';\n\nconst SEND_MESSAGE = gql`\n    mutation SendMessage($username: String!, $content: String!, $gid: Int!, $cType: String!){\n        createMessage(sender:$username, group:$gid, content:$content, cType:$cType){\n            id\n            content\n            ts\n        }\n    }\n`;\nconst themes = {\n    defaultTheme: {\n        FixedWrapperMaximized: {\n            css: {\n                boxShadow: '0 0 1em rgba(0, 0, 0, 0.1)',\n            },\n        },\n        OwnMessage: {\n            ...defaultTheme.OwnMessage,\n            backgroundColor: '#456456',\n            secondaryTextColor: '#456456',\n        },\n    },\n    purpleTheme: {\n        ...purpleTheme,\n        TextComposer: {\n            ...purpleTheme.TextComposer,\n            css: {\n                ...purpleTheme.TextComposer.css,\n                marginTop: '1em',\n            },\n        },\n        OwnMessage: {\n            ...purpleTheme.OwnMessage,\n            secondaryTextColor: '#fff',\n        },\n    },\n    elegantTheme: {\n        ...elegantTheme,\n        Message: {\n            ...darkTheme.Message,\n            secondaryTextColor: '#fff',\n        },\n        OwnMessage: {\n            ...darkTheme.OwnMessage,\n            secondaryTextColor: '#fff',\n        },\n    },\n    darkTheme: {\n        ...darkTheme,\n        vars: {\n            ...darkTheme.vars,\n            \"tertiary-color\": \"rgba(40, 40, 40, 0.8)\"\n        },\n        Message: {\n            ...darkTheme.Message,\n            css: {\n                ...darkTheme.Message.css,\n                color: '#fff',\n            },\n        },\n        OwnMessage: {\n            ...darkTheme.OwnMessage,\n            secondaryTextColor: '#fff',\n        },\n        TitleBar: {\n            ...darkTheme.TitleBar,\n            css: {\n                ...darkTheme.TitleBar.css,\n                padding: '1em',\n            },\n        },\n    },\n}\n\nfunction ChatMain({ client }) {\n    const inputEl = useRef(null);\n    const fileUploader = useRef(null);\n    const username = localStorage.getItem('username');\n    const [messageInput, setMessageInput] = useState(\"\");\n    const [createMessage] = useMutation(SEND_MESSAGE);\n\n    const [selectedGroup, setSelectedGroup] = useState(null);\n    const [doneFetching, setDoneFetching] = useState(false)\n    const [show, setShow] = useState(false);\n    const [showAdd, setShowAdd] = useState(false);\n\n\n    const logout = () => {\n        localStorage.clear();\n        let fullURL = window.location.href.split('/');\n        fullURL.pop();\n        const baseURL = fullURL.join('/')\n        window.location.href = baseURL;\n    }\n\n    return (<div className=\"main\">\n        <GroupChatTags show={show} setShow={setShow} />\n        <AddGroupMember show={showAdd} setShow={setShowAdd} groupId={selectedGroup}/>\n        <ThemeProvider theme={themes.darkTheme}>\n            <div style={{\n                height: \"100%\",\n                width: \"30%\",\n                position: \"fixed\",\n                zIndex: 1,\n                top: 0,\n                overflowX: 'hidden',\n                paddingTop: '20px',\n                left: 0\n            }}>\n                <div style={{ verticalAlign: 'middle', fontSize: 24 }}>\n                    <Avatar name={username} size={50} round style={{ marginBottom: 20, marginLeft: 25 }} title={`@${username}`} /> {`@${username}`}\n                </div>\n                <div className=\"App\" style={{ marginBottom: 10 }}>\n                    {selectedGroup && <Button variant=\"primary\" style={{ marginRight: \"10px\" }} onClick={() => setShowAdd(!showAdd)}>Add Member to Chat</Button>}\n                    <Button variant=\"primary\" style={{ marginRight: \"10px\" }} onClick={() => setShow(!show)}>Create Group Chat</Button>\n                    <Button variant=\"secondary\" onClick={logout}>Logout</Button>\n                </div>\n                <ChatLeftList client={client} selectedGroup={selectedGroup} setSelectedGroup={setSelectedGroup} setDoneFetching={setDoneFetching}>\n                </ChatLeftList>\n            </div>\n\n            <div style={{\n                height: \"100%\",\n                width: \"70%\",\n                position: \"fixed\",\n                zIndex: 1,\n                top: 0,\n                overflowX: 'hidden',\n                right: 0,\n                borderLeft: \"1px solid white\",\n            }}>\n                {\n                    selectedGroup && (\n                        <>\n                        <div styles={{overflow:\"hidden\"}}>\n                            <div style = {{height:\"90%\", position:\"relative\",}}>\n                                <ChatMessages selectedGroup={selectedGroup} doneFetching={doneFetching} setDoneFetching={setDoneFetching} />\n                            </div>\n                            <div style = {{paddingLeft: \"1px\", height:\"5%\", bottom:\"1%\", position:\"fixed\", width:\"68%\"}}>\n                                <Input\n                                    placeholder=\"Enter message\"\n                                    defaultValue=\"\"\n                                    ref={inputEl}\n                                    multiline={true}\n                                    // buttonsFloat='left'\n                                    // maxHeight= {0}\n                                    // minHeight = {0}\n                                    // autoHeight = {false}\n                                    onKeyPress={(e) => {\n                                        if (e.shiftKey && e.charCode === 13) {\n                                            return true;\n                                        }\n                                        if (e.charCode === 13 && inputEl.current.input.value.trim()!==\"\") {\n                                            createMessage({ variables: { username, gid: selectedGroup, content: encryptMessage(inputEl.current.input.value, \"text\", selectedGroup), cType: \"text\" } });\n                                            inputEl.current.clear();\n                                            e.preventDefault();\n                                            return false;\n                                        }\n                                    }}\n                                    rightButtons={\n                                        <>\n                                            <input\n                                                id=\"raised-button-file\"\n                                                style = {{display:\"none\"}}\n                                                type=\"file\"\n                                                ref={fileUploader}\n                                                onChange={(event, newValue) => {\n                                                    convertFileToBase64(event, selectedGroup, createMessage, username)\n                                                    // createMessage({ variables: { username, gid: selectedGroup, content: convertFileToBase64(event, selectedGroup), cType: \"file\" } });\n                                                    event.preventDefault();\n                                                }}\n                                            />\n                                        <ChatButton text='Upload' onClick={()=>{fileUploader.current.click()}}>\n                                        </ChatButton>\n                                        <ChatButton\n                                        text='Send'\n                                        onClick={(e) => {\n                                            if(inputEl.current.input.value.trim()!==\"\"){\n                                                createMessage({ variables: { username, gid: selectedGroup, content: encryptMessage(inputEl.current.input.value, \"text\", selectedGroup), cType: \"text\" } });\n                                                inputEl.current.clear();\n                                                e.preventDefault();\n                                            }\n                                        }} />\n                                    </>\n                                    } />\n                            </div>\n                        </div>\n                        </>\n                    )}\n            </div>\n        </ThemeProvider>\n    </div >);\n}\n\nexport default ChatMain;","import React from 'react';\nimport './../App.css';\nimport { ApolloClient, InMemoryCache, createHttpLink, ApolloProvider } from '@apollo/client';\nimport ChatMain from './ChatMain.react';\nimport { setContext } from '@apollo/client/link/context';\nimport { split } from '@apollo/client';\nimport { getMainDefinition } from '@apollo/client/utilities';\nimport { WebSocketLink } from '@apollo/client/link/ws';\n\nfunction ChatMainApolloProvider() {\n    const PRODUCTION = window.location.href.includes(\"https://rithik.me/\");\n    const serverURL = PRODUCTION ? 'https://e2-chat.herokuapp.com' : 'http://localhost:4000';\n    const wsURL = PRODUCTION ? 'wss://e2-chat.herokuapp.com' : 'ws://localhost:4000';\n    const token = localStorage.getItem('token');\n    const httpLink = createHttpLink({\n        uri: `${serverURL}/graphql`,\n    });\n\n    const authLink = setContext((_, { headers }) => {\n        return {\n            headers: {\n                ...headers,\n                authorization: token ? `${token}` : \"\",\n            }\n        }\n    });\n\n    const wsLink = new WebSocketLink({\n        uri: `${wsURL}/graphql`,\n        options: {\n            reconnect: true,\n            connectionParams: {\n                Authorization: token,\n            },\n        }\n    });\n\n    const splitLink = split(\n        ({ query }) => {\n            const definition = getMainDefinition(query);\n            return (\n                definition.kind === 'OperationDefinition' &&\n                definition.operation === 'subscription'\n            );\n        },\n        wsLink,\n        authLink.concat(httpLink),\n    );\n\n    const client = new ApolloClient({\n        link: splitLink,\n        cache: new InMemoryCache()\n    });\n\n    return (<ApolloProvider client={client}>\n        <div>\n            <ChatMain client={client} />\n        </div>\n    </ApolloProvider>);\n}\n\nexport default ChatMainApolloProvider;\n","import React, { useState } from 'react';\nimport './../App.css';\nimport { generateKeys, generatePasswordHash } from '../utils/generateKeys'\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField'\nimport { gql, useMutation, useQuery } from '@apollo/client';\nimport Alert from '@material-ui/lab/Alert';\nimport IconButton from '@material-ui/core/IconButton';\nimport Collapse from '@material-ui/core/Collapse';\nimport CloseIcon from '@material-ui/icons/Close';\nimport Tabs from 'react-bootstrap/Tabs';\nimport Tab from 'react-bootstrap/Tab';\nimport { encryptLocalStorage, setLocalStorage } from '../utils/localStorageKeyGen';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\n\n\nconst customTheme = createMuiTheme({\n\toverrides: {\n\t\tMuiFormLabel: { root: { color: 'white', borderColor: 'white' } },\n\t\tMuiOutlinedInput: {\n\t\t\troot: {\n\t\t\t\t'& $notchedOutline': {\n\t\t\t\t\tborderColor: 'rgba(255, 255, 255, 0.23)',\n\t\t\t\t},\n\t\t\t\t'&:hover:not($disabled):not($focused):not($error) $notchedOutline': {\n\t\t\t\t\tborderColor: '#4A90E2',\n\t\t\t\t\t'@media (hover: none)': {\n\t\t\t\t\t\tborderColor: 'rgba(255, 255, 255, 0.23)',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t'&$focused $notchedOutline': {\n\t\t\t\t\tborderColor: '#4A90E2',\n\t\t\t\t\tborderWidth: 1,\n\t\t\t\t},\n\t\t\t}\n\t\t},\n\t\tMuiInput: {\n\t\t\tinput: {\n\t\t\t\t\"&::placeholder\": {\n\t\t\t\t\tcolor: \"gray\"\n\t\t\t\t},\n\t\t\t\tcolor: \"white\", // if you also want to change the color of the input, this is the prop you'd use\n\t\t\t}\n\t\t}\n\t}\n});\n\n\nconst CREATE_USER = gql`\n\tmutation CreateUser($username: String!, $publicKey: String!){\n\t  createUser(username:$username, publicKey:$publicKey){\n\t    id\n\t    username\n\t    publicKey\n\t  }\n\t}\n`;\nconst CREATE_TOKEN = gql`\n\tmutation CreateToken($username: String!, $publicKey: String!){\n\t\t  createToken(username:$username, publicKey:$publicKey){\n\t\t    token\n\t\t    username\n\t\t}\n\t}\n`;\nconst GET_USER = gql`\n\tquery User($username: String!){\n\t\tuser(username:$username){\n\t\t\tusername\n\t\t\tid\n\t\t\tkeys\n\t\t}\n\t}\n`;\n\nconst UPDATE_KEYS = gql`\n    mutation updateKeys($username: String!, $keys: String!){\n        updateKeys(username:$username, keys:$keys){\n            success\n        }\n    }\n`;\n\n// register the user\nfunction Register() {\n\tconst [updateKeys] = useMutation(UPDATE_KEYS);\n\tconst [createUser] = useMutation(CREATE_USER, {\n\t\tonCompleted({ createUser }) {\n\t\t\tconst username = createUser.username;\n\t\t\tconst publicKey = createUser.publicKey;\n\t\t\tcreateToken({ variables: { username, publicKey } });\n\t\t}\n\t});\n\tconst [createToken] = useMutation(CREATE_TOKEN, {\n\t\tonCompleted({ createToken }) {\n\t\t\tconst password = tab === 'login' ? loginPassword : registerPassword;\n\t\t\tlocalStorage.setItem('token', createToken.token);\n\t\t\tlocalStorage.setItem('username', createToken.username);\n\t\t\tlocalStorage.setItem('password', generatePasswordHash(password));\n\t\t\tupdateKeys({ variables: { username: createToken.username, keys: encryptLocalStorage() } });\n\t\t\twindow.location.href = window.location.href + 'main';\n\t\t}\n\t});\n\n\tconst [createLoginToken] = useMutation(CREATE_TOKEN, {\n\t\tonCompleted({ createToken }) {\n\t\t\tlocalStorage.setItem('token', createToken.token);\n\t\t\twindow.location.href = window.location.href + 'main';\n\t\t}\n\t});\n\n\tconst [registerUsername, setRegisterUsername] = useState('');\n\tconst [registerPassword, setRegisterPassword] = useState('');\n\n\tconst [loginUsername, setLoginUsername] = useState('');\n\tconst [loginPassword, setLoginPassword] = useState('');\n\n\tconst [registerUsernameError, setRegisterUsernameError] = useState(false);\n\tconst [loginError, setLoginError] = useState(false);\n\n\tconst [buttonPressed, setButtonPressed] = useState(false);\n\n\tconst [tab, setTab] = useState('login');\n\n\tconst { error, refetch } = useQuery(GET_USER, {\n\t\tvariables: { username: tab === 'login' ? loginUsername : registerUsername },\n\t});\n\n\tconst setKeys = async (myUsernameValue) => {\n\t\tconst username = tab === 'login' ? loginUsername : registerUsername;\n\t\tPromise.resolve(generateKeys(myUsernameValue, 4096)).then(function (array) {\n\t\t\tconst publicKey = array.publicKey\n\t\t\tconst privateKey = array.privateKey\n\t\t\tcreateUser({ variables: { username, publicKey } });\n\t\t\tlocalStorage.setItem('user-publicKey', publicKey);\n\t\t\tlocalStorage.setItem('user-privateKey', privateKey);\n\t\t\tlocalStorage.setItem('username', username);\n\t\t});\n\t}\n\n\tconst registerUser = async () => {\n\t\tconst { data: userData } = await refetch({ username: registerUsername });\n\t\tif (error) {\n\t\t\tsetKeys(registerUsername);\n\t\t}\n\t\telse {\n\t\t\tif (userData.user == null) {\n\t\t\t\tsetRegisterUsernameError(false);\n\t\t\t\tsetKeys(registerUsername);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tsetRegisterUsernameError(true);\n\t\t\t\tsetButtonPressed(false);\n\t\t\t}\n\t\t}\n\t}\n\n\tconst loginUser = async () => {\n\t\tconst { data: userData } = await refetch({ username: loginUsername });\n\t\tif (error) {\n\t\t\tconsole.error(error);\n\t\t\tsetLoginError(true);\n\t\t\tsetButtonPressed(false);\n\t\t}\n\t\telse {\n\t\t\tif (userData.user === null) {\n\t\t\t\tsetLoginError(true);\n\t\t\t\tsetButtonPressed(false);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconst hashedPassword = generatePasswordHash(loginPassword);\n\t\t\t\tconst success = setLocalStorage(userData.user.keys, hashedPassword);\n\t\t\t\tif (success) {\n\t\t\t\t\tconst username = localStorage.getItem('username');\n\t\t\t\t\tconst publicKey = localStorage.getItem('user-publicKey');\n\t\t\t\t\tcreateLoginToken({ variables: { username, publicKey } });\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tsetLoginError(true);\n\t\t\t\t\tsetButtonPressed(false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn (\n\t\t<ThemeProvider theme={customTheme}>\n\t\t\t<Tabs fill={true}\n\t\t\t\tid=\"controlled-tab-example\"\n\t\t\t\tclassName=\"tabHeadings\"\n\t\t\t\tactiveKey={tab}\n\t\t\t\tonSelect={(k) => setTab(k)}\n\t\t\t>\n\t\t\t\t<Tab eventKey=\"login\" title=\"Login\">\n\t\t\t\t\t<div className=\"register\">\n\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\t\tstyle: { color: \"white\" },\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tid=\"outlined-basic\" label=\"Username\"\n\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\tvalue={loginUsername}\n\t\t\t\t\t\t\tcolor={'secondary'}\n\t\t\t\t\t\t\tfullWidth={true}\n\t\t\t\t\t\t\tonChange={(e) => setLoginUsername(e.target.value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\t\tstyle: { color: \"white\" },\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tid=\"outlined-basic\" label=\"Password\"\n\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\tvalue={loginPassword}\n\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\tcolor={'secondary'}\n\t\t\t\t\t\t\tfullWidth={true}\n\t\t\t\t\t\t\tonChange={(e) => setLoginPassword(e.target.value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<Button disabled={buttonPressed} onClick={(e) => {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tsetButtonPressed(true);\n\t\t\t\t\t\t\tloginUser()\n\t\t\t\t\t\t}} variant=\"contained\" color=\"secondary\">\n\t\t\t\t\t\t\t{buttonPressed && <CircularProgress\n\t\t\t\t\t\t\t\tsize={20}\n\t\t\t\t\t\t\t\tstyle={{ color: 'white', marginRight: '10px' }}\n\t\t\t\t\t\t\t/>} Login\n\t\t\t</Button>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<Collapse in={loginError}>\n\t\t\t\t\t\t\t<Alert\n\t\t\t\t\t\t\t\taction={\n\t\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\t\taria-label=\"close\"\n\t\t\t\t\t\t\t\t\t\tcolor=\"inherit\"\n\t\t\t\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\tsetLoginError(false);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<CloseIcon fontSize=\"inherit\" />\n\t\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvariant=\"filled\" severity=\"error\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tInvalid Login\n\t\t\t\t</Alert>\n\t\t\t\t\t\t</Collapse>\n\n\t\t\t\t\t</div>\n\t\t\t\t</Tab>\n\t\t\t\t<Tab eventKey=\"register\" title=\"Register\">\n\t\t\t\t\t<div className=\"register\">\n\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\t\tstyle: { color: \"white\" },\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tid=\"outlined-basic\" label=\"Username\"\n\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\tvalue={registerUsername}\n\t\t\t\t\t\t\tcolor={'secondary'}\n\t\t\t\t\t\t\tfullWidth={true}\n\t\t\t\t\t\t\tonChange={(e) => setRegisterUsername(e.target.value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\tInputProps={{\n\t\t\t\t\t\t\t\tstyle: { color: \"white\" },\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tid=\"outlined-basic\" label=\"Password\"\n\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t\tvalue={registerPassword}\n\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\tcolor={'secondary'}\n\t\t\t\t\t\t\tfullWidth={true}\n\t\t\t\t\t\t\tonChange={(e) => setRegisterPassword(e.target.value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<Button disabled={buttonPressed} onClick={(e) => {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tsetButtonPressed(true);\n\t\t\t\t\t\t\tregisterUser();\n\t\t\t\t\t\t}} variant=\"contained\" color=\"secondary\">\n\t\t\t\t\t\t\t{buttonPressed && <CircularProgress\n\t\t\t\t\t\t\t\tsize={20}\n\t\t\t\t\t\t\t\tstyle={{ color: 'white', marginRight: '10px' }}\n\t\t\t\t\t\t\t/>} Register\n\t\t\t</Button>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<Collapse in={registerUsernameError}>\n\t\t\t\t\t\t\t<Alert\n\t\t\t\t\t\t\t\taction={\n\t\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\t\taria-label=\"close\"\n\t\t\t\t\t\t\t\t\t\tcolor=\"inherit\"\n\t\t\t\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\tsetRegisterUsernameError(false);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<CloseIcon fontSize=\"inherit\" />\n\t\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvariant=\"filled\" severity=\"error\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tInvalid username - choose a unique username\n\t\t\t\t</Alert>\n\t\t\t\t\t\t</Collapse>\n\n\t\t\t\t\t</div>\n\t\t\t\t</Tab>\n\t\t\t</Tabs>\n\t\t</ThemeProvider>\n\t);\n}\n\nexport default Register;\n","import React from 'react';\nimport './../App.css';\nimport Register from './register.react'\nimport { ApolloClient, InMemoryCache, createHttpLink, ApolloProvider } from '@apollo/client';\nimport { setContext } from '@apollo/client/link/context';\nimport { split } from '@apollo/client';\nimport { getMainDefinition } from '@apollo/client/utilities';\nimport { WebSocketLink } from '@apollo/client/link/ws';\n\nfunction RegisterApolloProvider() {\n    const PRODUCTION = window.location.href.includes(\"https://rithik.me/\");\n    const serverURL = PRODUCTION ? 'https://e2-chat.herokuapp.com' : 'http://localhost:4000';\n    const wsURL = PRODUCTION ? 'wss://e2-chat.herokuapp.com' : 'ws://localhost:4000';\n    const token = localStorage.getItem('token');\n    const httpLink = createHttpLink({\n        uri: `${serverURL}/graphql`,\n    });\n\n    const authLink = setContext((_, { headers }) => {\n        return {\n            headers: {\n                ...headers,\n                authorization: token ? `${token}` : \"\",\n            }\n        }\n    });\n\n    const wsLink = new WebSocketLink({\n        uri: `${wsURL}/graphql`,\n        options: {\n            reconnect: true,\n            connectionParams: {\n                Authorization: token,\n            },\n        }\n    });\n\n    const splitLink = split(\n        ({ query }) => {\n            const definition = getMainDefinition(query);\n            return (\n                definition.kind === 'OperationDefinition' &&\n                definition.operation === 'subscription'\n            );\n        },\n        wsLink,\n        authLink.concat(httpLink),\n    );\n\n    const client = new ApolloClient({\n        link: splitLink,\n        cache: new InMemoryCache()\n    });\n\n    return (<ApolloProvider client={client}>\n        <div className=\"App\">\n            <header className=\"App-header\">\n                <Register />\n            </header>\n        </div>\n    </ApolloProvider>);\n}\n\nexport default RegisterApolloProvider;\n","import React from 'react';\nimport './App.css';\nimport {\n  Switch,\n  Route,\n  HashRouter\n} from \"react-router-dom\";\nimport ChatMainApolloProvider from './components/ChatMainApolloProvider.react';\nimport RegisterApolloProvider from './components/RegisterApolloProvider.react';\n\nfunction App() {\n  return (\n    <HashRouter basename='/'>\n      <Switch>\n        <Route path=\"/main\">\n          <ChatMainApolloProvider />\n        </Route>\n        <Route path=\"/\">\n          <RegisterApolloProvider />\n        </Route>\n      </Switch>\n    </HashRouter>\n\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.Fragment>\n    <App />\n  </React.Fragment>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}